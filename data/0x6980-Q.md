# Report

## Non-critical Issues

| |Issue|Instances|
|-|:-|:-:|
| [N-01](#N-01) | Execution at deadlines should be allowed | 1 | 
| [N-02](#N-02) | Re-org attack | 2 | 
| [N-03](#N-03) | `address.isContract()` is not a reliable way of checking if the input is an EOA | 12 | 
| [N-04](#N-04) | Array lengths not checked | 1 | 
| [N-05](#N-05) |  `abi.encodePacked()` should not be used with dynamic types when passing the result to a hash function such as `keccak256()` | 1 | 
| [N-06](#N-06) | Double type casts create complexity within the code | 1 | 
| [N-07](#N-07) | Emitting storage values instead of the memory one | 2 | 
| [N-08](#N-08) | For loops in `public` or `external` functions should be avoided due to high gas costs and possible DOS | 14 | 
| [N-09](#N-09) | Function calls within for loops | 3 | 
| [N-10](#N-10) | Missing limits when setting min/max amounts | 4 | 
| [N-11](#N-11) | Two or more functions contain the same code | 21 | 
| [N-12](#N-12) | TransferOwnership Should Be Two Step | 3 | 
| [N-13](#N-13) | Adding a `return` statement when the function defines a named return variable, is redundant | 1 | 
| [N-14](#N-14) | Consistent usage of `require` vs custom `error` | 1 | 
| [N-15](#N-15) | Empty `bytes` check is missing | 19 | 
| [N-16](#N-16) | It is standard for all external and public functions to be override from an interface | 72 | 
| [N-17](#N-17) | Function definition modifier order does not follow Solidity style guide | 1 | 
| [N-18](#N-18) | Function names should differ to make the code more readable | 1 | 
| [N-19](#N-19) | Hardcoded `address` should be avoided | 4 | 
| [N-20](#N-20) | Use uppercase and underscore for `immutable`s | 21 | 
| [N-21](#N-21) | Imports could be organized more systematically | 14 | 
| [N-22](#N-22) | Erorr declaration should include NatSpec documentation | 55 | 
| [N-23](#N-23) | Event declaration should include NatSpec documentation | 16 | 
| [N-24](#N-24) | State variable declaration should include NatSpec documentation | 30 | 
| [N-25](#N-25) | `override` function arguments that are unused should have the variable name removed or commented out to avoid compiler warnings | 35 | 
| [N-26](#N-26) | public function names should should use mixedCase | 3 | 
| [N-27](#N-27) | Unused named `return` | 2 | 
| [N-28](#N-28) | Unusual loop variable | 3 | 
| [N-29](#N-29) | Functions not used internally could be marked external | 30 | 
| [N-30](#N-30) | Use a single file for system wide constants | 13 | 
| [N-31](#N-31) | Using underscore at the end of variable name | 4 | 
| [N-32](#N-32) | OpenZeppelin libraries should be upgraded to a newer version | 1 | 
| [N-33](#N-33) | Non-usage of specific imports | 82 | 

## Non-critical Issues

### <a name="N-01"></a>[N-01] Execution at deadlines should be allowed
The condition may be wrong in these cases, as when block.timestamp is equal to the compared > or < variable these blocks will not be executed.

*Instances (1)*:

```solidity
File: governance/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol

167:         if (block.timestamp < thisElectionStartTs) {

```

[167](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol#L167)

### <a name="N-02"></a>[N-02] Re-org attack
Re-orgs can happen in all EVM chains. In ethereum, where currently Frankencoin is deployed, it is not “super common” but it still happens, being the last one less than a year ago: [ethereum-beacon-chain-blockchain-reorg](https://decrypt.co/101390/ethereum-beacon-chain-blockchain-reorg) The issue increases the changes of happening if deploying on L2’s/ rollups. where re-orgs have been much more active: [polygon-hit-by-157-block-reorg-despite-hard-fork-to-reduce-reorgs](https://protos.com/polygon-hit-by-157-block-reorg-despite-hard-fork-to-reduce-reorgs/) being the last one, less than a year ago. Deploy the cloned Contract via create2 with a specific salt that includes msg.sender and address `_existing`

*Instances (2)*:

```solidity
File: governance/src/security-council-mgmt/factories/L2SecurityCouncilMgmtFactory.sol

75:         return address(new TransparentUpgradeableProxy(impl, proxyAdmin, initData));

158:         deployedContracts.upgradeExecRouteBuilder = new UpgradeExecRouteBuilder({
159:                 _upgradeExecutors: dp.upgradeExecutors,
160:                 _l1ArbitrumTimelock: dp.l1ArbitrumTimelock,
161:                 _l1TimelockMinDelay: dp.l1TimelockMinDelay
162:             });

```

[75](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/factories/L2SecurityCouncilMgmtFactory.sol#L75), [158-162](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/factories/L2SecurityCouncilMgmtFactory.sol#L158-L162)



### <a name="N-03"></a>[N-03] `address.isContract()` is not a reliable way of checking if the input is an EOA

*Instances (12)*:
<details>
<summary>see instances</summary>


```solidity
File: governance/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/GovernanceChainSCMgmtActivationAction.sol

93:             Address.isContract(securityCouncilManager),

```

[93](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/GovernanceChainSCMgmtActivationAction.sol#L93)

```solidity
File: governance/src/security-council-mgmt/SecurityCouncilManager.sol

112:         if (!Address.isContract(_l2CoreGovTimelock)) {

318:         if (!Address.isContract(routerAddress)) {

```

[112](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L112), [318](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L318)

```solidity
File: governance/src/security-council-mgmt/factories/L2SecurityCouncilMgmtFactory.sol

86:         if (!Address.isContract(dp.govChainEmergencySecurityCouncil)) {

90:         if (!Address.isContract(dp.govChainProxyAdmin)) {

94:         if (!Address.isContract(dp.l2UpgradeExecutor)) {

98:         if (!Address.isContract(dp.arbToken)) {

```

[86](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/factories/L2SecurityCouncilMgmtFactory.sol#L86), [90](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/factories/L2SecurityCouncilMgmtFactory.sol#L90), [94](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/factories/L2SecurityCouncilMgmtFactory.sol#L94), [98](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/factories/L2SecurityCouncilMgmtFactory.sol#L98)

```solidity
File: governance/src/security-council-mgmt/governors/SecurityCouncilMemberElectionGovernor.sol

68:         if (!Address.isContract(address(_nomineeElectionGovernor))) {

72:         if (!Address.isContract(address(_securityCouncilManager))) {

```

[68](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberElectionGovernor.sol#L68), [72](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberElectionGovernor.sol#L72)

```solidity
File: governance/src/security-council-mgmt/governors/SecurityCouncilMemberRemovalGovernor.sol

78:         if (!Address.isContract(address(_securityCouncilManager))) {

```

[78](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberRemovalGovernor.sol#L78)

```solidity
File: governance/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol

115:         if (!Address.isContract(address(params.securityCouncilManager))) {

119:         if (!Address.isContract(address(params.securityCouncilMemberElectionGovernor))) {

```

[115](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol#L115), [119](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol#L119)

</details>

### <a name="N-04"></a>[N-04] Array lengths not checked
If the length of the arrays are not required to be of the same length, user operations may not be fully executed due to a mismatch in the number of items iterated over, versus the number of items provided in the second array

*Instances (1)*:

```solidity
File: governance/src/security-council-mgmt/governors/SecurityCouncilMemberElectionGovernor.sol

115:     function _execute(
116:             uint256 proposalId,
117:             address[] memory, /* targets */
118:             uint256[] memory, /* values */
119:             bytes[] memory callDatas,
120:             bytes32 /* descriptionHash */
121:         ) internal override {

```

[115-121](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberElectionGovernor.sol#L115-L121)

### <a name="N-05"></a>[N-05]  `abi.encodePacked()` should not be used with dynamic types when passing the result to a hash function such as `keccak256()`
Use `abi.encode()` instead which will pad items to 32 bytes, which will [prevent hash collisions](https://docs.soliditylang.org/en/v0.8.13/abi-spec.html#non-standard-packed-mode) (e.g. `abi.encodePacked(0x123,0x456)` => `0x123456` => `abi.encodePacked(0x1,0x23456)`, but `abi.encode(0x123,0x456)` => `0x0...1230...456`). "Unless there is a compelling reason, `abi.encode` should be preferred". If there is only one argument to `abi.encodePacked()` it can often be cast to `bytes()` or `bytes32()` [instead](https://ethereum.stackexchange.com/questions/30912/how-to-compare-strings-in-solidity#answer-82739).
If all arguments are strings and or bytes, `bytes.concat()` should be used instead

*Instances (1)*:

```solidity
File: governance/src/security-council-mgmt/SecurityCouncilManager.sol

375:         return keccak256(abi.encodePacked(_members, nonce));

```

[375](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L375)

### <a name="N-06"></a>[N-06] Double type casts create complexity within the code
Double type casting should be avoided in Solidity contracts to prevent unintended consequences and ensure accurate data representation. Performing multiple type casts in succession can lead to unexpected truncation, rounding errors, or loss of precision, potentially compromising the contract's functionality and reliability. Furthermore, double type casting can make the code less readable and harder to maintain, increasing the likelihood of errors and misunderstandings during development and debugging. To ensure precise and consistent data handling, developers should use appropriate data types and avoid unnecessary or excessive type casting, promoting a more robust and dependable contract execution.

*Instances (1)*:

```solidity
File: governance/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/GovernanceChainSCMgmtActivationAction.sol

67:             ICoreTimelock(address(l2AddressRegistry.coreGovTimelock()));

```

[67](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/GovernanceChainSCMgmtActivationAction.sol#L67)

### <a name="N-07"></a>[N-07] Emitting storage values instead of the memory one
Emitted values should not be read from storage again. Instead, the existing values from memory should be used.

*Instances (2)*:

```solidity
File: governance/src/security-council-mgmt/SecurityCouncilManager.sol

/// @audit securityCouncils
266:             securityCouncils.length

/// @audit securityCouncils
299:                     securityCouncils.length

```

[266](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L266), [299](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L299)

### <a name="N-08"></a>[N-08] For loops in `public` or `external` functions should be avoided due to high gas costs and possible DOS
In Solidity, for loops can potentially cause Denial of Service (DoS) attacks if not handled carefully. DoS attacks can occur when an attacker intentionally exploits the gas cost of a function, causing it to run out of gas or making it too expensive for other users to call. Below are some scenarios where for loops can lead to DoS attacks: Nested for loops can become exceptionally gas expensive and should be used sparingly.

*Instances (14)*:
<details>
<summary>see instances</summary>


```solidity
File: governance/src/UpgradeExecRouteBuilder.sol

/// @audit on line 76
67:     constructor(
68:            ChainAndUpExecLocation[] memory _upgradeExecutors,
69:            address _l1ArbitrumTimelock,
70:            uint256 _l1TimelockMinDelay
71:        ) {
72:            if (_l1ArbitrumTimelock == address(0)) {
73:                revert ZeroAddress();
74:            }
75:    
76:            for (uint256 i = 0; i < _upgradeExecutors.length; i++) {
77:                ChainAndUpExecLocation memory chainAndUpExecLocation = _upgradeExecutors[i];
78:                if (chainAndUpExecLocation.location.upgradeExecutor == address(0)) {
79:                    revert ZeroAddress();
80:                }
81:                if (upExecLocationExists(chainAndUpExecLocation.chainId)) {
82:                    revert UpgradeExecAlreadyExists(chainAndUpExecLocation.chainId);
83:                }
84:                upExecLocations[chainAndUpExecLocation.chainId] = chainAndUpExecLocation.location;
85:            }
86:    
87:            l1TimelockAddr = _l1ArbitrumTimelock;
88:            l1TimelockMinDelay = _l1TimelockMinDelay;
89:        }

/// @audit on line 129
105:     function createActionRouteData(
106:             uint256[] memory chainIds,
107:             address[] memory actionAddresses,
108:             uint256[] memory actionValues,
109:             bytes[] memory actionDatas,
110:             bytes32 predecessor,
111:             bytes32 timelockSalt
112:         ) public view returns (address, bytes memory) {
113:             if (chainIds.length != actionAddresses.length) {
114:                 revert ParamLengthMismatch(chainIds.length, actionAddresses.length);
115:             }
116:             if (chainIds.length != actionValues.length) {
117:                 revert ParamLengthMismatch(chainIds.length, actionValues.length);
118:             }
119:             if (chainIds.length != actionDatas.length) {
120:                 revert ParamLengthMismatch(chainIds.length, actionDatas.length);
121:             }
122:     
123:             address[] memory schedTargets = new address[](chainIds.length);
124:             uint256[] memory schedValues = new uint256[](chainIds.length);
125:             bytes[] memory schedData = new bytes[](chainIds.length);
126:     
127:             // for each chain create calldata that targets the upgrade executor
128:             // from the l1 timelock
129:             for (uint256 i = 0; i < chainIds.length; i++) {
130:                 UpExecLocation memory upExecLocation = upExecLocations[chainIds[i]];
131:                 if (upExecLocation.upgradeExecutor == address(0)) {
132:                     revert UpgadeExecDoesntExist(chainIds[i]);
133:                 }
134:                 if (actionDatas[i].length == 0) {
135:                     revert EmptyActionBytesData(actionDatas);
136:                 }
137:     
138:                 bytes memory executorData = abi.encodeWithSelector(
139:                     UpgradeExecutor.execute.selector, actionAddresses[i], actionDatas[i]
140:                 );
141:     
142:                 // for L1, inbox is set to address(0):
143:                 if (upExecLocation.inbox == address(0)) {
144:                     schedTargets[i] = upExecLocation.upgradeExecutor;
145:                     schedValues[i] = actionValues[i];
146:                     schedData[i] = executorData;
147:                 } else {
148:                     // For L2 actions, magic is top level target, and value and calldata are encoded in payload
149:                     schedTargets[i] = RETRYABLE_TICKET_MAGIC;
150:                     schedValues[i] = 0;
151:                     schedData[i] = abi.encode(
152:                         upExecLocation.inbox,
153:                         upExecLocation.upgradeExecutor,
154:                         actionValues[i],
155:                         0,
156:                         0,
157:                         executorData
158:                     );
159:                 }
160:             }
161:     
162:             // batch those calls to execute from the l1 timelock
163:             bytes memory timelockCallData = abi.encodeWithSelector(
164:                 L1ArbitrumTimelock.scheduleBatch.selector,
165:                 schedTargets,
166:                 schedValues,
167:                 schedData,
168:                 predecessor,
169:                 timelockSalt,
170:                 l1TimelockMinDelay
171:             );
172:     
173:             // create a message to initiate a withdrawal to the L1 timelock
174:             return (
175:                 address(100),
176:                 abi.encodeWithSelector(ArbSys.sendTxToL1.selector, l1TimelockAddr, timelockCallData)
177:             );
178:         }

/// @audit on line 193
186:     function createActionRouteDataWithDefaults(
187:             uint256[] memory chainIds,
188:             address[] memory actionAddresses,
189:             bytes32 timelockSalt
190:         ) public view returns (address, bytes memory) {
191:             uint256[] memory values = new uint256[](chainIds.length);
192:             bytes[] memory actionDatas = new bytes[](chainIds.length);
193:             for (uint256 i = 0; i < chainIds.length; i++) {
194:                 actionDatas[i] = DEFAULT_GOV_ACTION_CALLDATA;
195:                 values[i] = DEFAULT_VALUE;
196:             }
197:             return createActionRouteData(
198:                 chainIds, actionAddresses, values, actionDatas, DEFAULT_PREDECESSOR, timelockSalt
199:             );
200:         }

```

[67-89](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/UpgradeExecRouteBuilder.sol#L67-L89), [105-178](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/UpgradeExecRouteBuilder.sol#L105-L178), [186-200](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/UpgradeExecRouteBuilder.sol#L186-L200)

```solidity
File: governance/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/SecurityCouncilMgmtUpgradeLib.sol

/// @audit on lines 61, 63, 74, 76
52:     function areAddressArraysEqual(address[] memory array1, address[] memory array2)
53:            public
54:            pure
55:            returns (bool)
56:        {
57:            if (array1.length != array2.length) {
58:                return false;
59:            }
60:    
61:            for (uint256 i = 0; i < array1.length; i++) {
62:                bool found = false;
63:                for (uint256 j = 0; j < array2.length; j++) {
64:                    if (array1[i] == array2[j]) {
65:                        found = true;
66:                        break;
67:                    }
68:                }
69:                if (!found) {
70:                    return false;
71:                }
72:            }
73:    
74:            for (uint256 i = 0; i < array2.length; i++) {
75:                bool found = false;
76:                for (uint256 j = 0; j < array1.length; j++) {
77:                    if (array2[i] == array1[j]) {
78:                        found = true;
79:                        break;
80:                    }
81:                }
82:                if (!found) {
83:                    return false;
84:                }
85:            }
86:    
87:            return true;
88:        }

```

[52-88](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/SecurityCouncilMgmtUpgradeLib.sol#L52-L88)

```solidity
File: governance/src/security-council-mgmt/SecurityCouncilManager.sol

/// @audit on lines 106, 118
89:     function initialize(
90:            address[] memory _firstCohort,
91:            address[] memory _secondCohort,
92:            SecurityCouncilData[] memory _securityCouncils,
93:            SecurityCouncilManagerRoles memory _roles,
94:            address payable _l2CoreGovTimelock,
95:            UpgradeExecRouteBuilder _router
96:        ) external initializer {
97:            if (_firstCohort.length != _secondCohort.length) {
98:                revert CohortLengthMismatch(_firstCohort, _secondCohort);
99:            }
100:            firstCohort = _firstCohort;
101:            secondCohort = _secondCohort;
102:            cohortSize = _firstCohort.length;
103:            _grantRole(DEFAULT_ADMIN_ROLE, _roles.admin);
104:            _grantRole(COHORT_REPLACER_ROLE, _roles.cohortUpdator);
105:            _grantRole(MEMBER_ADDER_ROLE, _roles.memberAdder);
106:            for (uint256 i = 0; i < _roles.memberRemovers.length; i++) {
107:                _grantRole(MEMBER_REMOVER_ROLE, _roles.memberRemovers[i]);
108:            }
109:            _grantRole(MEMBER_ROTATOR_ROLE, _roles.memberRotator);
110:            _grantRole(MEMBER_REPLACER_ROLE, _roles.memberReplacer);
111:    
112:            if (!Address.isContract(_l2CoreGovTimelock)) {
113:                revert NotAContract({account: _l2CoreGovTimelock});
114:            }
115:            l2CoreGovTimelock = _l2CoreGovTimelock;
116:    
117:            _setUpgradeExecRouteBuilder(_router);
118:            for (uint256 i = 0; i < _securityCouncils.length; i++) {
119:                _addSecurityCouncil(_securityCouncils[i]);
120:            }
121:        }

/// @audit on line 135
124:     function replaceCohort(address[] memory _newCohort, Cohort _cohort)
125:             external
126:             onlyRole(COHORT_REPLACER_ROLE)
127:         {
128:             if (_newCohort.length != cohortSize) {
129:                 revert InvalidNewCohortLength({cohort: _newCohort, cohortSize: cohortSize});
130:             }
131:     
132:             // delete the old cohort
133:             _cohort == Cohort.FIRST ? delete firstCohort : delete secondCohort;
134:     
135:             for (uint256 i = 0; i < _newCohort.length; i++) {
136:                 _addMemberToCohortArray(_newCohort[i], _cohort);
137:             }
138:     
139:             _scheduleUpdate();
140:             emit CohortReplaced(_newCohort, _cohort);
141:         }

/// @audit on line 284
279:     function removeSecurityCouncil(SecurityCouncilData memory _securityCouncilData)
280:             external
281:             onlyRole(DEFAULT_ADMIN_ROLE)
282:             returns (bool)
283:         {
284:             for (uint256 i = 0; i < securityCouncils.length; i++) {
285:                 SecurityCouncilData storage securityCouncilData = securityCouncils[i];
286:                 if (
287:                     securityCouncilData.securityCouncil == _securityCouncilData.securityCouncil
288:                         && securityCouncilData.chainId == _securityCouncilData.chainId
289:                         && securityCouncilData.updateAction == _securityCouncilData.updateAction
290:                 ) {
291:                     SecurityCouncilData storage lastSecurityCouncil =
292:                         securityCouncils[securityCouncils.length - 1];
293:     
294:                     securityCouncils[i] = lastSecurityCouncil;
295:                     securityCouncils.pop();
296:                     emit SecurityCouncilRemoved(
297:                         securityCouncilData.securityCouncil,
298:                         securityCouncilData.updateAction,
299:                         securityCouncils.length
300:                     );
301:                     return true;
302:                 }
303:             }
304:             revert SecurityCouncilNotInManager(_securityCouncilData);
305:         }

/// @audit on lines 339, 342
337:     function getBothCohorts() public view returns (address[] memory) {
338:             address[] memory members = new address[](firstCohort.length + secondCohort.length);
339:             for (uint256 i = 0; i < firstCohort.length; i++) {
340:                 members[i] = firstCohort[i];
341:             }
342:             for (uint256 i = 0; i < secondCohort.length; i++) {
343:                 members[firstCohort.length + i] = secondCohort[i];
344:             }
345:             return members;
346:         }

/// @audit on line 392
379:     function getScheduleUpdateInnerData(uint256 nonce)
380:             public
381:             view
382:             returns (address[] memory, address, bytes memory)
383:         {
384:             // build a union array of security council members
385:             address[] memory newMembers = getBothCohorts();
386:     
387:             // build batch call to L1 timelock
388:             address[] memory actionAddresses = new address[](securityCouncils.length);
389:             bytes[] memory actionDatas = new bytes[](securityCouncils.length);
390:             uint256[] memory chainIds = new uint256[](securityCouncils.length);
391:     
392:             for (uint256 i = 0; i < securityCouncils.length; i++) {
393:                 SecurityCouncilData memory securityCouncilData = securityCouncils[i];
394:                 actionAddresses[i] = securityCouncilData.updateAction;
395:                 chainIds[i] = securityCouncilData.chainId;
396:                 actionDatas[i] = abi.encodeWithSelector(
397:                     SecurityCouncilMemberSyncAction.perform.selector,
398:                     securityCouncilData.securityCouncil,
399:                     newMembers,
400:                     nonce
401:                 );
402:             }
403:     
404:             // unique salt used for replay protection in the L1 timelock
405:             bytes32 salt = this.generateSalt(newMembers, nonce);
406:             (address to, bytes memory data) = router.createActionRouteData(
407:                 chainIds,
408:                 actionAddresses,
409:                 new uint256[](securityCouncils.length), // all values are always 0
410:                 actionDatas,
411:                 0,
412:                 salt
413:             );
414:     
415:             return (newMembers, to, data);
416:         }

```

[89-121](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L89-L121), [124-141](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L124-L141), [279-305](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L279-L305), [337-346](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L337-L346), [379-416](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L379-L416)

```solidity
File: governance/src/security-council-mgmt/SecurityCouncilMemberSyncAction.sol

/// @audit on lines 60, 67
31:     function perform(address _securityCouncil, address[] memory _updatedMembers, uint256 _nonce)
32:            external
33:            returns (bool res)
34:        {
35:            // make sure that _nonce is greater than the last nonce
36:            // we do this to ensure that a previous update does not occur after a later one
37:            // the mechanism just checks greater, not n+1, because the Security Council Manager always
38:            // sends the latest full list of members so it doesn't matter if some updates are missed
39:            // Additionally a retryable ticket could be used to execute the update, and since tickets
40:            // expire if not executed after some time, then allowing updates to be skipped means that the
41:            // system will not be blocked if a retryable ticket is expires
42:            uint256 updateNonce = getUpdateNonce(_securityCouncil);
43:            if (_nonce <= updateNonce) {
44:                // when nonce is too now, we simply return, we don't revert.
45:                // this way an out of date update will actual execute, rather than remaining in an unexecuted state forever
46:                emit UpdateNonceTooLow(_securityCouncil, updateNonce, _nonce);
47:                return false;
48:            }
49:    
50:            // store the nonce as a record of execution
51:            // use security council as the key to ensure that updates to different security councils are kept separate
52:            _setUpdateNonce(_securityCouncil, _nonce);
53:    
54:            IGnosisSafe securityCouncil = IGnosisSafe(_securityCouncil);
55:            // preserve current threshold, the safe ensures that the threshold is never lower than the member count
56:            uint256 threshold = securityCouncil.getThreshold();
57:    
58:            address[] memory previousOwners = securityCouncil.getOwners();
59:    
60:            for (uint256 i = 0; i < _updatedMembers.length; i++) {
61:                address member = _updatedMembers[i];
62:                if (!securityCouncil.isOwner(member)) {
63:                    _addMember(securityCouncil, member, threshold);
64:                }
65:            }
66:    
67:            for (uint256 i = 0; i < previousOwners.length; i++) {
68:                address owner = previousOwners[i];
69:                if (!SecurityCouncilMgmtUtils.isInArray(owner, _updatedMembers)) {
70:                    _removeMember(securityCouncil, owner, threshold);
71:                }
72:            }
73:            return true;
74:        }

/// @audit on line 105
97:     function getPrevOwner(IGnosisSafe securityCouncil, address _owner)
98:            public
99:            view
100:            returns (address)
101:        {
102:            // owners are stored as a linked list and removal requires the previous owner
103:            address[] memory owners = securityCouncil.getOwners();
104:            address previousOwner = SENTINEL_OWNERS;
105:            for (uint256 i = 0; i < owners.length; i++) {
106:                address currentOwner = owners[i];
107:                if (currentOwner == _owner) {
108:                    return previousOwner;
109:                }
110:                previousOwner = currentOwner;
111:            }
112:            revert PreviousOwnerNotFound({
113:                targetOwner: _owner,
114:                securityCouncil: address(securityCouncil)
115:            });
116:        }

```

[31-74](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilMemberSyncAction.sol#L31-L74), [97-116](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilMemberSyncAction.sol#L97-L116)

```solidity
File: governance/src/security-council-mgmt/factories/L2SecurityCouncilMgmtFactory.sol

/// @audit on lines 111, 117
81:     function deploy(DeployParams memory dp, ContractImplementations memory impls)
82:            external
83:            onlyOwner
84:            returns (DeployedContracts memory)
85:        {
86:            if (!Address.isContract(dp.govChainEmergencySecurityCouncil)) {
87:                revert NotAContract(dp.govChainEmergencySecurityCouncil);
88:            }
89:    
90:            if (!Address.isContract(dp.govChainProxyAdmin)) {
91:                revert NotAContract(dp.govChainProxyAdmin);
92:            }
93:    
94:            if (!Address.isContract(dp.l2UpgradeExecutor)) {
95:                revert NotAContract(dp.l2UpgradeExecutor);
96:            }
97:    
98:            if (!Address.isContract(dp.arbToken)) {
99:                revert NotAContract(dp.arbToken);
100:            }
101:    
102:            if (dp.nomineeVetter == address(0)) {
103:                revert ZeroAddress();
104:            }
105:            IGnosisSafe govChainEmergencySCSafe = IGnosisSafe(dp.govChainEmergencySecurityCouncil);
106:            address[] memory owners = govChainEmergencySCSafe.getOwners();
107:            if (owners.length != (dp.firstCohort.length + dp.secondCohort.length)) {
108:                revert InvalidCohortsSize(owners.length, dp.firstCohort.length, dp.secondCohort.length);
109:            }
110:    
111:            for (uint256 i = 0; i < dp.firstCohort.length; i++) {
112:                if (!govChainEmergencySCSafe.isOwner(dp.firstCohort[i])) {
113:                    revert AddressNotInCouncil(owners, dp.firstCohort[i]);
114:                }
115:            }
116:    
117:            for (uint256 i = 0; i < dp.secondCohort.length; i++) {
118:                if (!govChainEmergencySCSafe.isOwner(dp.secondCohort[i])) {
119:                    revert AddressNotInCouncil(owners, dp.secondCohort[i]);
120:                }
121:            }
122:    
123:            DeployedContracts memory deployedContracts;
124:    
125:            // deploy nominee election governor
126:            deployedContracts.nomineeElectionGovernor = SecurityCouncilNomineeElectionGovernor(
127:                payable(_deployProxy(dp.govChainProxyAdmin, impls.nomineeElectionGovernor, ""))
128:            );
129:    
130:            // deploy member election governor
131:            deployedContracts.memberElectionGovernor = SecurityCouncilMemberElectionGovernor(
132:                payable(_deployProxy(dp.govChainProxyAdmin, impls.memberElectionGovernor, ""))
133:            );
134:    
135:            // deploy security council manager
136:            deployedContracts.securityCouncilManager = SecurityCouncilManager(
137:                _deployProxy(dp.govChainProxyAdmin, impls.securityCouncilManager, "")
138:            );
139:    
140:            // deploy security council member remover gov
141:            deployedContracts.securityCouncilMemberRemoverGov = SecurityCouncilMemberRemovalGovernor(
142:                payable(_deployProxy(dp.govChainProxyAdmin, impls.securityCouncilMemberRemoverGov, ""))
143:            );
144:    
145:            // create council manager roles
146:            address[] memory memberRemovers = new address[](2);
147:            memberRemovers[0] = address(deployedContracts.securityCouncilMemberRemoverGov);
148:            memberRemovers[1] = dp.govChainEmergencySecurityCouncil;
149:            SecurityCouncilManagerRoles memory roles = SecurityCouncilManagerRoles({
150:                admin: dp.l2UpgradeExecutor,
151:                cohortUpdator: address(deployedContracts.memberElectionGovernor),
152:                memberAdder: dp.govChainEmergencySecurityCouncil,
153:                memberRemovers: memberRemovers,
154:                memberRotator: dp.govChainEmergencySecurityCouncil,
155:                memberReplacer: dp.govChainEmergencySecurityCouncil
156:            });
157:    
158:            deployedContracts.upgradeExecRouteBuilder = new UpgradeExecRouteBuilder({
159:                _upgradeExecutors: dp.upgradeExecutors,
160:                _l1ArbitrumTimelock: dp.l1ArbitrumTimelock,
161:                _l1TimelockMinDelay: dp.l1TimelockMinDelay
162:            });
163:    
164:            // init the deployed contracts
165:            _initElectionGovernors(
166:                dp,
167:                deployedContracts.securityCouncilManager,
168:                deployedContracts.nomineeElectionGovernor,
169:                deployedContracts.memberElectionGovernor
170:            );
171:    
172:            deployedContracts.securityCouncilManager.initialize({
173:                _firstCohort: dp.firstCohort,
174:                _secondCohort: dp.secondCohort,
175:                _securityCouncils: dp.securityCouncils,
176:                _roles: roles,
177:                _l2CoreGovTimelock: payable(dp.l2CoreGovTimelock),
178:                _router: deployedContracts.upgradeExecRouteBuilder
179:            });
180:    
181:            _initRemovalGov(
182:                dp,
183:                deployedContracts.securityCouncilManager,
184:                deployedContracts.securityCouncilMemberRemoverGov
185:            );
186:    
187:            emit ContractsDeployed(deployedContracts);
188:            return deployedContracts;
189:        }

```

[81-189](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/factories/L2SecurityCouncilMgmtFactory.sol#L81-L189)

```solidity
File: governance/src/security-council-mgmt/governors/modules/SecurityCouncilMemberElectionGovernorCountingUpgradeable.sol

/// @audit on line 181
177:     function topNominees(uint256 proposalId) public view returns (address[] memory) {
178:             address[] memory nominees = _compliantNominees(proposalId);
179:             uint240[] memory weights = new uint240[](nominees.length);
180:             ElectionInfo storage election = _elections[proposalId];
181:             for (uint256 i = 0; i < nominees.length; i++) {
182:                 weights[i] = election.weightReceived[nominees[i]];
183:             }
184:             return selectTopNominees(nominees, weights, _targetMemberCount());
185:         }

/// @audit on lines 205, 215
191:     function selectTopNominees(address[] memory nominees, uint240[] memory weights, uint256 k)
192:             public
193:             pure
194:             returns (address[] memory)
195:         {
196:             if (nominees.length != weights.length) {
197:                 revert LengthsDontMatch(nominees.length, weights.length);
198:             }
199:             if (nominees.length < k) {
200:                 revert NotEnoughNominees(nominees.length, k);
201:             }
202:     
203:             uint256[] memory topNomineesPacked = new uint256[](k);
204:     
205:             for (uint16 i = 0; i < nominees.length; i++) {
206:                 uint256 packed = (uint256(weights[i]) << 16) | i;
207:     
208:                 if (topNomineesPacked[0] < packed) {
209:                     topNomineesPacked[0] = packed;
210:                     LibSort.insertionSort(topNomineesPacked);
211:                 }
212:             }
213:     
214:             address[] memory topNomineesAddresses = new address[](k);
215:             for (uint16 i = 0; i < k; i++) {
216:                 topNomineesAddresses[i] = nominees[uint16(topNomineesPacked[i])];
217:             }
218:     
219:             return topNomineesAddresses;
220:         }

```

[177-185](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilMemberElectionGovernorCountingUpgradeable.sol#L177-L185), [191-220](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilMemberElectionGovernorCountingUpgradeable.sol#L191-L220)

</details>

### <a name="N-09"></a>[N-09] Function calls within for loops
Making function calls within loops in Solidity can lead to inefficient gas usage, potential bottlenecks, and increased vulnerability to attacks. Each function call or external call consumes gas, and when executed within a loop, the gas cost multiplies, potentially causing the transaction to run out of gas or exceed block gas limits. This can result in transaction failure or unpredictable behavior.

*Instances (3)*:

```solidity
File: governance/src/UpgradeExecRouteBuilder.sol

/// @audit upExecLocationExists() on line 81
76:         for (uint256 i = 0; i < _upgradeExecutors.length; i++) {
77:                ChainAndUpExecLocation memory chainAndUpExecLocation = _upgradeExecutors[i];
78:                if (chainAndUpExecLocation.location.upgradeExecutor == address(0)) {
79:                    revert ZeroAddress();
80:                }
81:                if (upExecLocationExists(chainAndUpExecLocation.chainId)) {
82:                    revert UpgradeExecAlreadyExists(chainAndUpExecLocation.chainId);
83:                }
84:                upExecLocations[chainAndUpExecLocation.chainId] = chainAndUpExecLocation.location;
85:            }

```

[76-85](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/UpgradeExecRouteBuilder.sol#L76-L85)

```solidity
File: governance/src/security-council-mgmt/SecurityCouncilMemberSyncAction.sol

/// @audit _addMember() on line 63
60:         for (uint256 i = 0; i < _updatedMembers.length; i++) {
61:                address member = _updatedMembers[i];
62:                if (!securityCouncil.isOwner(member)) {
63:                    _addMember(securityCouncil, member, threshold);
64:                }
65:            }

/// @audit _removeMember() on line 70
67:         for (uint256 i = 0; i < previousOwners.length; i++) {
68:                address owner = previousOwners[i];
69:                if (!SecurityCouncilMgmtUtils.isInArray(owner, _updatedMembers)) {
70:                    _removeMember(securityCouncil, owner, threshold);
71:                }
72:            }

```

[60-65](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilMemberSyncAction.sol#L60-L65), [67-72](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilMemberSyncAction.sol#L67-L72)

### <a name="N-10"></a>[N-10] Missing limits when setting min/max amounts
There are some missing limits in these functions, and this could lead to unexpected scenarios. Consider adding a min/max limit for the following values, when appropriate.

*Instances (4)*:

```solidity
File: governance/src/gov-action-contracts/execution-record/KeyValueStore.sol

11:     function set(uint256 key, uint256 value) external {

```

[11](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/execution-record/KeyValueStore.sol#L11)

```solidity
File: governance/src/security-council-mgmt/governors/SecurityCouncilMemberRemovalGovernor.sol

182:     function _setVoteSuccessNumerator(uint256 _voteSuccessNumerator) internal {

```

[182](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberRemovalGovernor.sol#L182)

```solidity
File: governance/src/security-council-mgmt/governors/modules/SecurityCouncilMemberElectionGovernorCountingUpgradeable.sol

68:     function __SecurityCouncilMemberElectionGovernorCounting_init(uint256 initialFullWeightDuration)

```

[68](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilMemberElectionGovernorCountingUpgradeable.sol#L68)

```solidity
File: governance/src/security-council-mgmt/governors/modules/SecurityCouncilNomineeElectionGovernorTiming.sol

28:     function __SecurityCouncilNomineeElectionGovernorTiming_init(

```

[28](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilNomineeElectionGovernorTiming.sol#L28)

### <a name="N-11"></a>[N-11] Two or more functions contain the same code
In Solidity programming, duplicate code in multiple functions introduces potential security risks and maintainability issues. It magnifies the impact of any bugs or vulnerabilities, since developers must fix these in every location where the code is replicated. Overlooking any instance of replicated code could leave vulnerabilities intact. Furthermore, code duplication leads to contract bloating, diminishing the readability and manageability of the code. Future logic changes would need to be applied in every location where the code is replicated, increasing the complexity of updates. To resolve this, it is recommended to consolidate duplicate code into a single internal function, and replace the duplicate instances with calls to this new function. This approach streamlines the code, reducing the attack surface and making it easier to maintain and update.

*Instances (21)*:
<details>
<summary>see instances</summary>


```solidity
File: governance/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/GovernanceChainSCMgmtActivationAction.sol

48:     function perform() external {
49:            IUpgradeExecutor upgradeExecutor = IUpgradeExecutor(l2AddressRegistry.coreGov().owner());
50:    
51:            // swap in new emergency security council
52:            SecurityCouncilMgmtUpgradeLib.replaceEmergencySecurityCouncil({
53:                _prevSecurityCouncil: prevEmergencySecurityCouncil,
54:                _newSecurityCouncil: newEmergencySecurityCouncil,
55:                _threshold: emergencySecurityCouncilThreshold,
56:                _upgradeExecutor: upgradeExecutor
57:            });
58:    
59:            // swap in new nonEmergency security council
60:            SecurityCouncilMgmtUpgradeLib.requireSafesEquivalent(
61:                prevNonEmergencySecurityCouncil,
62:                newNonEmergencySecurityCouncil,
63:                nonEmergencySecurityCouncilThreshold
64:            );
65:    
66:            ICoreTimelock l2CoreGovTimelock =
67:                ICoreTimelock(address(l2AddressRegistry.coreGovTimelock()));
68:    
69:            bytes32 TIMELOCK_PROPOSAL_ROLE = l2CoreGovTimelock.PROPOSER_ROLE();
70:            bytes32 TIMELOCK_CANCELLER_ROLE = l2CoreGovTimelock.CANCELLER_ROLE();
71:    
72:            require(
73:                l2CoreGovTimelock.hasRole(
74:                    TIMELOCK_PROPOSAL_ROLE, address(prevNonEmergencySecurityCouncil)
75:                ),
76:                "GovernanceChainSCMgmtActivationAction: prev nonemergency council doesn't have proposal role"
77:            );
78:            require(
79:                !l2CoreGovTimelock.hasRole(
80:                    TIMELOCK_PROPOSAL_ROLE, address(newNonEmergencySecurityCouncil)
81:                ),
82:                "GovernanceChainSCMgmtActivationAction: new nonemergency council already has proposal role"
83:            );
84:    
85:            l2CoreGovTimelock.revokeRole(
86:                TIMELOCK_PROPOSAL_ROLE, address(prevNonEmergencySecurityCouncil)
87:            );
88:    
89:            l2CoreGovTimelock.grantRole(TIMELOCK_PROPOSAL_ROLE, address(newNonEmergencySecurityCouncil));
90:    
91:            // give timelock access to manager
92:            require(
93:                Address.isContract(securityCouncilManager),
94:                "GovernanceChainSCMgmtActivationAction: manager address isn't a contract"
95:            );
96:    
97:            require(
98:                !l2CoreGovTimelock.hasRole(TIMELOCK_PROPOSAL_ROLE, securityCouncilManager),
99:                "GovernanceChainSCMgmtActivationAction: securityCouncilManager already has proposal role"
100:            );
101:            l2CoreGovTimelock.grantRole(TIMELOCK_PROPOSAL_ROLE, securityCouncilManager);
102:    
103:            // revoke old security council cancel role; it is unnecessary to grant it to explicitly grant it to new security council since the security council can already cancel via the core governor's relay method.
104:            require(
105:                l2CoreGovTimelock.hasRole(
106:                    TIMELOCK_CANCELLER_ROLE, address(prevEmergencySecurityCouncil)
107:                ),
108:                "GovernanceChainSCMgmtActivationAction: prev emergency security council should have cancellor role"
109:            );
110:    
111:            l2CoreGovTimelock.revokeRole(TIMELOCK_CANCELLER_ROLE, address(prevEmergencySecurityCouncil));
112:    
113:            // confirm updates
114:            bytes32 EXECUTOR_ROLE = upgradeExecutor.EXECUTOR_ROLE();
115:            require(
116:                upgradeExecutor.hasRole(EXECUTOR_ROLE, address(newEmergencySecurityCouncil)),
117:                "NonGovernanceChainSCMgmtActivationAction: new emergency security council not set"
118:            );
119:            require(
120:                !upgradeExecutor.hasRole(EXECUTOR_ROLE, address(prevEmergencySecurityCouncil)),
121:                "NonGovernanceChainSCMgmtActivationAction: prev emergency security council still set"
122:            );
123:    
124:            require(
125:                !l2CoreGovTimelock.hasRole(
126:                    TIMELOCK_PROPOSAL_ROLE, address(prevNonEmergencySecurityCouncil)
127:                ),
128:                "GovernanceChainSCMgmtActivationAction: prev nonemergency council still has proposal role"
129:            );
130:            require(
131:                l2CoreGovTimelock.hasRole(
132:                    TIMELOCK_PROPOSAL_ROLE, address(newNonEmergencySecurityCouncil)
133:                ),
134:                "GovernanceChainSCMgmtActivationAction: new nonemergency doesn't have proposal role"
135:            );
136:    
137:            require(
138:                l2CoreGovTimelock.hasRole(TIMELOCK_PROPOSAL_ROLE, securityCouncilManager),
139:                "GovernanceChainSCMgmtActivationAction: securityCouncilManager doesn't have proposal role"
140:            );
141:            require(
142:                !l2CoreGovTimelock.hasRole(
143:                    TIMELOCK_CANCELLER_ROLE, address(prevEmergencySecurityCouncil)
144:                ),
145:                "GovernanceChainSCMgmtActivationAction: prev emergency security council still has cancellor role"
146:            );
147:        }

```

[48-147](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/GovernanceChainSCMgmtActivationAction.sol#L48-L147)

```solidity
File: governance/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/L1SCMgmtActivationAction.sol

30:     function perform() external {
31:            // swap in new emergency security council
32:            SecurityCouncilMgmtUpgradeLib.replaceEmergencySecurityCouncil({
33:                _prevSecurityCouncil: prevEmergencySecurityCouncil,
34:                _newSecurityCouncil: newEmergencySecurityCouncil,
35:                _threshold: emergencySecurityCouncilThreshold,
36:                _upgradeExecutor: l1UpgradeExecutor
37:            });
38:    
39:            // swap in new emergency security counicl canceller role
40:            bytes32 TIMELOCK_CANCELLER_ROLE = l1Timelock.CANCELLER_ROLE();
41:            require(
42:                l1Timelock.hasRole(TIMELOCK_CANCELLER_ROLE, address(prevEmergencySecurityCouncil)),
43:                "GovernanceChainSCMgmtActivationAction: prev emergency security council should have cancellor role"
44:            );
45:            require(
46:                !l1Timelock.hasRole(TIMELOCK_CANCELLER_ROLE, address(l1UpgradeExecutor)),
47:                "GovernanceChainSCMgmtActivationAction: l1UpgradeExecutor already has cancellor role"
48:            );
49:    
50:            l1Timelock.revokeRole(TIMELOCK_CANCELLER_ROLE, address(prevEmergencySecurityCouncil));
51:            l1Timelock.grantRole(TIMELOCK_CANCELLER_ROLE, address(l1UpgradeExecutor));
52:    
53:            // confirm updates
54:            require(
55:                l1Timelock.hasRole(TIMELOCK_CANCELLER_ROLE, address(l1UpgradeExecutor)),
56:                "GovernanceChainSCMgmtActivationAction: l1UpgradeExecutor canceller role not set"
57:            );
58:            require(
59:                !l1Timelock.hasRole(TIMELOCK_CANCELLER_ROLE, address(prevEmergencySecurityCouncil)),
60:                "GovernanceChainSCMgmtActivationAction: prevEmergencySecurityCouncil canceller role not revoked"
61:            );
62:        }

```

[30-62](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/L1SCMgmtActivationAction.sol#L30-L62)

```solidity
File: governance/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/NonGovernanceChainSCMgmtActivationAction.sol

25:     function perform() external {
26:            // swap in new memgency security council
27:            SecurityCouncilMgmtUpgradeLib.replaceEmergencySecurityCouncil({
28:                _prevSecurityCouncil: prevEmergencySecurityCouncil,
29:                _newSecurityCouncil: newEmergencySecurityCouncil,
30:                _threshold: emergencySecurityCouncilThreshold,
31:                _upgradeExecutor: upgradeExecutor
32:            });
33:    
34:            // confirm updates
35:            bytes32 EXECUTOR_ROLE = upgradeExecutor.EXECUTOR_ROLE();
36:            require(
37:                upgradeExecutor.hasRole(EXECUTOR_ROLE, address(newEmergencySecurityCouncil)),
38:                "NonGovernanceChainSCMgmtActivationAction: new emergency security council not set"
39:            );
40:            require(
41:                !upgradeExecutor.hasRole(EXECUTOR_ROLE, address(prevEmergencySecurityCouncil)),
42:                "NonGovernanceChainSCMgmtActivationAction: prev emergency security council still set"
43:            );
44:        }

```

[25-44](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/NonGovernanceChainSCMgmtActivationAction.sol#L25-L44)

```solidity
File: governance/src/security-council-mgmt/governors/SecurityCouncilMemberElectionGovernor.sol

103:     function relay(address target, uint256 value, bytes calldata data)
104:             external
105:             virtual
106:             override
107:             onlyOwner
108:         {
109:             AddressUpgradeable.functionCallWithValue(target, data, value);
110:         }

```

[103-110](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberElectionGovernor.sol#L103-L110)

```solidity
File: governance/src/security-council-mgmt/governors/SecurityCouncilMemberRemovalGovernor.sol

163:     function _countVote(
164:             uint256 proposalId,
165:             address account,
166:             uint8 support,
167:             uint256 weight,
168:             bytes memory params
169:         ) internal virtual override(GovernorCountingSimpleUpgradeable, GovernorUpgradeable) {
170:             if (VoteType(support) == VoteType.Abstain) {
171:                 revert AbstainDisallowed();
172:             }
173:             GovernorCountingSimpleUpgradeable._countVote(proposalId, account, support, weight, params);
174:         }

203:     function relay(address target, uint256 value, bytes calldata data)
204:             external
205:             virtual
206:             override
207:             onlyOwner
208:         {
209:             AddressUpgradeable.functionCallWithValue(target, data, value);
210:         }

```

[163-174](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberRemovalGovernor.sol#L163-L174), [203-210](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberRemovalGovernor.sol#L203-L210)

```solidity
File: governance/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol

254:     function relay(address target, uint256 value, bytes calldata data)
255:             external
256:             virtual
257:             override
258:             onlyOwner
259:         {
260:             AddressUpgradeable.functionCallWithValue(target, data, value);
261:         }

```

[254-261](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol#L254-L261)

```solidity
File: governance/src/security-council-mgmt/governors/modules/SecurityCouncilMemberElectionGovernorCountingUpgradeable.sol

95:     function _countVote(
96:            uint256 proposalId,
97:            address account,
98:            uint8 support,
99:            uint256 availableVotes,
100:            bytes memory params
101:        ) internal virtual override {
102:            if (support != 1) {
103:                revert InvalidSupport(support);
104:            }
105:    
106:            if (params.length != 64) {
107:                revert UnexpectedParamsLength(params.length);
108:            }
109:    
110:            (address nominee, uint256 votes) = abi.decode(params, (address, uint256));
111:            if (!_isCompliantNominee(proposalId, nominee)) {
112:                revert NotCompliantNominee(nominee);
113:            }
114:    
115:            uint240 weight = votesToWeight(proposalId, block.number, votes);
116:            if (weight == 0) {
117:                revert ZeroWeightVote(block.number, votes);
118:            }
119:    
120:            ElectionInfo storage election = _elections[proposalId];
121:            uint256 prevVotesUsed = election.votesUsed[account];
122:            if (prevVotesUsed + votes > availableVotes) {
123:                revert InsufficientVotes(prevVotesUsed, votes, availableVotes);
124:            }
125:    
126:            uint240 prevWeightReceived = election.weightReceived[nominee];
127:            election.votesUsed[account] = prevVotesUsed + votes;
128:            election.weightReceived[nominee] = prevWeightReceived + weight;
129:    
130:            emit VoteCastForNominee({
131:                voter: account,
132:                proposalId: proposalId,
133:                nominee: nominee,
134:                votes: votes,
135:                weight: weight,
136:                totalUsedVotes: prevVotesUsed + votes,
137:                usableVotes: availableVotes,
138:                weightReceived: election.weightReceived[nominee]
139:            });
140:        }

148:     function votesUsed(uint256 proposalId, address account) public view returns (uint256) {
149:             return _elections[proposalId].votesUsed[account];
150:         }

158:     function hasVoted(uint256 proposalId, address account) public view override returns (bool) {
159:             return votesUsed(proposalId, account) > 0;
160:         }

267:     function _quorumReached(uint256) internal pure override returns (bool) {
268:             return true;
269:         }

267:     function _quorumReached(uint256) internal pure override returns (bool) {
268:             return true;
269:         }

273:     function _voteSucceeded(uint256) internal pure override returns (bool) {
274:             return true;
275:         }

273:     function _voteSucceeded(uint256) internal pure override returns (bool) {
274:             return true;
275:         }

```

[95-140](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilMemberElectionGovernorCountingUpgradeable.sol#L95-L140), [148-150](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilMemberElectionGovernorCountingUpgradeable.sol#L148-L150), [158-160](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilMemberElectionGovernorCountingUpgradeable.sol#L158-L160), [267-269](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilMemberElectionGovernorCountingUpgradeable.sol#L267-L269), [267-269](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilMemberElectionGovernorCountingUpgradeable.sol#L267-L269), [273-275](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilMemberElectionGovernorCountingUpgradeable.sol#L273-L275), [273-275](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilMemberElectionGovernorCountingUpgradeable.sol#L273-L275)

```solidity
File: governance/src/security-council-mgmt/governors/modules/SecurityCouncilNomineeElectionGovernorCountingUpgradeable.sol

62:     function _countVote(
63:            uint256 proposalId,
64:            address account,
65:            uint8 support,
66:            uint256 weight,
67:            bytes memory params
68:        ) internal virtual override {
69:            if (support != 1) {
70:                revert InvalidSupport(support);
71:            }
72:    
73:            if (params.length != 64) {
74:                revert UnexpectedParamsLength(params.length);
75:            }
76:    
77:            // params is encoded as (address contender, uint256 votes)
78:            (address contender, uint256 votes) = abi.decode(params, (address, uint256));
79:    
80:            if (!isContender(proposalId, contender)) {
81:                revert NotEligibleContender(contender);
82:            }
83:            if (isNominee(proposalId, contender)) {
84:                revert NomineeAlreadyAdded(contender);
85:            }
86:    
87:            NomineeElectionCountingInfo storage election = _elections[proposalId];
88:            uint256 prevVotesUsed = election.votesUsed[account];
89:    
90:            if (votes + prevVotesUsed > weight) {
91:                revert InsufficientTokens(votes, prevVotesUsed, weight);
92:            }
93:    
94:            uint256 prevVotesReceived = election.votesReceived[contender];
95:            uint256 votesThreshold = quorum(proposalSnapshot(proposalId));
96:    
97:            uint256 actualVotes = votes;
98:            if (prevVotesReceived + votes >= votesThreshold) {
99:                // we pushed the contender over the line
100:                // we should only give the contender enough votes to get to the line so that we don't waste votes
101:                actualVotes = votesThreshold - prevVotesReceived;
102:    
103:                // push the contender to the nominees
104:                _addNominee(proposalId, contender);
105:            }
106:    
107:            election.votesUsed[account] = prevVotesUsed + actualVotes;
108:            election.votesReceived[contender] = prevVotesReceived + actualVotes;
109:    
110:            emit VoteCastForContender({
111:                proposalId: proposalId,
112:                voter: account,
113:                contender: contender,
114:                votes: actualVotes,
115:                totalUsedVotes: prevVotesUsed + actualVotes,
116:                usableVotes: weight
117:            });
118:        }

133:     function hasVoted(uint256 proposalId, address account) public view override returns (bool) {
134:             return _elections[proposalId].votesUsed[account] > 0;
135:         }

153:     function votesUsed(uint256 proposalId, address account) public view returns (uint256) {
154:             return _elections[proposalId].votesUsed[account];
155:         }

170:     function _quorumReached(uint256) internal pure override returns (bool) {
171:             return true;
172:         }

170:     function _quorumReached(uint256) internal pure override returns (bool) {
171:             return true;
172:         }

175:     function _voteSucceeded(uint256) internal pure override returns (bool) {
176:             return true;
177:         }

175:     function _voteSucceeded(uint256) internal pure override returns (bool) {
176:             return true;
177:         }

```

[62-118](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilNomineeElectionGovernorCountingUpgradeable.sol#L62-L118), [133-135](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilNomineeElectionGovernorCountingUpgradeable.sol#L133-L135), [153-155](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilNomineeElectionGovernorCountingUpgradeable.sol#L153-L155), [170-172](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilNomineeElectionGovernorCountingUpgradeable.sol#L170-L172), [170-172](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilNomineeElectionGovernorCountingUpgradeable.sol#L170-L172), [175-177](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilNomineeElectionGovernorCountingUpgradeable.sol#L175-L177), [175-177](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilNomineeElectionGovernorCountingUpgradeable.sol#L175-L177)

</details>

### <a name="N-12"></a>[N-12] TransferOwnership Should Be Two Step
Recommend considering implementing a two step process where the owner or admin nominates an account and the nominated account needs to call an acceptOwnership() function for the transfer of ownership to fully succeed. This ensures the nominated EOA account is a valid and active account.

*Instances (3)*:

```solidity
File: governance/src/security-council-mgmt/governors/SecurityCouncilMemberElectionGovernor.sol

66:         _transferOwnership(_owner);

```

[66](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberElectionGovernor.sol#L66)

```solidity
File: governance/src/security-council-mgmt/governors/SecurityCouncilMemberRemovalGovernor.sol

76:         _transferOwnership(_owner);

```

[76](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberRemovalGovernor.sol#L76)

```solidity
File: governance/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol

112:         _transferOwnership(params.owner);

```

[112](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol#L112)


### <a name="N-13"></a>[N-13] Adding a `return` statement when the function defines a named return variable, is redundant
Once the return variable has been assigned (or has its default value), there is no need to explicitly return it at the end of the function, since it's returned automatically

*Instances (1)*:

```solidity
File: governance/src/security-council-mgmt/SecurityCouncilMemberSyncAction.sol


73:         return true;

```

[73](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilMemberSyncAction.sol#L73)

### <a name="N-14"></a>[N-14] Consistent usage of `require` vs custom `error`
Consider using the same approach throughout the codebase to improve the consistency of the code.

`require` used: 22 

`cusntom error` used: 92 

*Instances (1)*:

```solidity
File: Various files

1: 

```

[1](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L1)

### <a name="N-15"></a>[N-15] Empty `bytes` check is missing
When developing smart contracts in Solidity, it's crucial to validate the inputs of your functions. This includes ensuring that the bytes parameters are not empty, especially when they represent crucial data such as addresses, identifiers, or raw data that the contract needs to process.
 Missing empty bytes checks can lead to unexpected behaviour in your contract. For instance, certain operations might fail, produce incorrect results, or consume unnecessary gas when performed with empty bytes. Moreover, missing input validation can potentially expose your contract to malicious activity, including exploitation of unhandled edge cases.
 To mitigate these issues, always validate that bytes parameters are not empty when the logic of your contract requires it.

*Instances (19)*:
<details>
<summary>see instances</summary>


```solidity
File: governance/src/UpgradeExecRouteBuilder.sol

/// @audit predecessor
105:     function createActionRouteData(
106:             uint256[] memory chainIds,
107:             address[] memory actionAddresses,
108:             uint256[] memory actionValues,
109:             bytes[] memory actionDatas,
110:             bytes32 predecessor,
111:             bytes32 timelockSalt
112:         ) public view returns (address, bytes memory) {

/// @audit timelockSalt
105:     function createActionRouteData(
106:             uint256[] memory chainIds,
107:             address[] memory actionAddresses,
108:             uint256[] memory actionValues,
109:             bytes[] memory actionDatas,
110:             bytes32 predecessor,
111:             bytes32 timelockSalt
112:         ) public view returns (address, bytes memory) {

/// @audit timelockSalt
186:     function createActionRouteDataWithDefaults(
187:             uint256[] memory chainIds,
188:             address[] memory actionAddresses,
189:             bytes32 timelockSalt
190:         ) public view returns (address, bytes memory) {

```

[105-112](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/UpgradeExecRouteBuilder.sol#L105-L112), [105-112](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/UpgradeExecRouteBuilder.sol#L105-L112), [186-190](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/UpgradeExecRouteBuilder.sol#L186-L190)

```solidity
File: governance/src/security-council-mgmt/SecurityCouncilMemberSyncAction.sol

/// @audit data
127:     function _execFromModule(IGnosisSafe securityCouncil, bytes memory data) internal {

```

[127](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilMemberSyncAction.sol#L127)

```solidity
File: governance/src/security-council-mgmt/factories/L2SecurityCouncilMgmtFactory.sol

/// @audit initData
71:     function _deployProxy(address proxyAdmin, address impl, bytes memory initData)
72:            internal
73:            returns (address)
74:        {

```

[71-74](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/factories/L2SecurityCouncilMgmtFactory.sol#L71-L74)

```solidity
File: governance/src/security-council-mgmt/governors/SecurityCouncilMemberElectionGovernor.sol

/// @audit data
103:     function relay(address target, uint256 value, bytes calldata data)
104:             external
105:             virtual
106:             override
107:             onlyOwner
108:         {

115:     function _execute(
116:             uint256 proposalId,
117:             address[] memory, /* targets */
118:             uint256[] memory, /* values */
119:             bytes[] memory callDatas,
120:             bytes32 /* descriptionHash */
121:         ) internal override {

206:     function castVoteBySig(uint256, uint8, uint8, bytes32, bytes32)
207:             public
208:             virtual
209:             override
210:             returns (uint256)
211:         {

206:     function castVoteBySig(uint256, uint8, uint8, bytes32, bytes32)
207:             public
208:             virtual
209:             override
210:             returns (uint256)
211:         {

```

[103-108](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberElectionGovernor.sol#L103-L108), [115-121](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberElectionGovernor.sol#L115-L121), [206-211](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberElectionGovernor.sol#L206-L211), [206-211](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberElectionGovernor.sol#L206-L211)

```solidity
File: governance/src/security-council-mgmt/governors/SecurityCouncilMemberRemovalGovernor.sol

/// @audit calldataWithSelector
90:     function separateSelector(bytes calldata calldataWithSelector)
91:            external
92:            pure
93:            returns (bytes4, bytes memory)
94:        {

/// @audit params
163:     function _countVote(
164:             uint256 proposalId,
165:             address account,
166:             uint8 support,
167:             uint256 weight,
168:             bytes memory params
169:         ) internal virtual override(GovernorCountingSimpleUpgradeable, GovernorUpgradeable) {

/// @audit data
203:     function relay(address target, uint256 value, bytes calldata data)
204:             external
205:             virtual
206:             override
207:             onlyOwner
208:         {

/// @audit params
223:     function _castVote(
224:             uint256 proposalId,
225:             address account,
226:             uint8 support,
227:             string memory reason,
228:             bytes memory params
229:         )
230:             internal
231:             override(GovernorUpgradeable, GovernorPreventLateQuorumUpgradeable)
232:             returns (uint256)
233:         {

```

[90-94](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberRemovalGovernor.sol#L90-L94), [163-169](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberRemovalGovernor.sol#L163-L169), [203-208](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberRemovalGovernor.sol#L203-L208), [223-233](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberRemovalGovernor.sol#L223-L233)

```solidity
File: governance/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol

/// @audit data
254:     function relay(address target, uint256 value, bytes calldata data)
255:             external
256:             virtual
257:             override
258:             onlyOwner
259:         {

324:     function _execute(
325:             uint256 proposalId,
326:             address[] memory, /* targets */
327:             uint256[] memory, /* values */
328:             bytes[] memory callDatas,
329:             bytes32 /*descriptionHash*/
330:         ) internal virtual override {

448:     function castVoteBySig(uint256, uint8, uint8, bytes32, bytes32)
449:             public
450:             virtual
451:             override
452:             returns (uint256)
453:         {

448:     function castVoteBySig(uint256, uint8, uint8, bytes32, bytes32)
449:             public
450:             virtual
451:             override
452:             returns (uint256)
453:         {

```

[254-259](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol#L254-L259), [324-330](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol#L324-L330), [448-453](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol#L448-L453), [448-453](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol#L448-L453)

```solidity
File: governance/src/security-council-mgmt/governors/modules/SecurityCouncilMemberElectionGovernorCountingUpgradeable.sol

/// @audit params
95:     function _countVote(
96:            uint256 proposalId,
97:            address account,
98:            uint8 support,
99:            uint256 availableVotes,
100:            bytes memory params
101:        ) internal virtual override {

```

[95-101](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilMemberElectionGovernorCountingUpgradeable.sol#L95-L101)

```solidity
File: governance/src/security-council-mgmt/governors/modules/SecurityCouncilNomineeElectionGovernorCountingUpgradeable.sol

/// @audit params
62:     function _countVote(
63:            uint256 proposalId,
64:            address account,
65:            uint8 support,
66:            uint256 weight,
67:            bytes memory params
68:        ) internal virtual override {

```

[62-68](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilNomineeElectionGovernorCountingUpgradeable.sol#L62-L68)

</details>

### <a name="N-16"></a>[N-16] It is standard for all external and public functions to be override from an interface
This is to ensure the whole API is extracted in a interface.

*Instances (72)*:
<details>
<summary>see instances</summary>


```solidity
File: governance/src/UpgradeExecRouteBuilder.sol

10:     function perform() external;

93:     function upExecLocationExists(uint256 _chainId) public view returns (bool) {

105:     function createActionRouteData(
106:             uint256[] memory chainIds,
107:             address[] memory actionAddresses,
108:             uint256[] memory actionValues,
109:             bytes[] memory actionDatas,
110:             bytes32 predecessor,
111:             bytes32 timelockSalt
112:         ) public view returns (address, bytes memory) {

186:     function createActionRouteDataWithDefaults(
187:             uint256[] memory chainIds,
188:             address[] memory actionAddresses,
189:             bytes32 timelockSalt
190:         ) public view returns (address, bytes memory) {

```

[10](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/UpgradeExecRouteBuilder.sol#L10), [93](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/UpgradeExecRouteBuilder.sol#L93), [105-112](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/UpgradeExecRouteBuilder.sol#L105-L112), [186-190](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/UpgradeExecRouteBuilder.sol#L186-L190)

```solidity
File: governance/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/GovernanceChainSCMgmtActivationAction.sol

48:     function perform() external {

```

[48](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/GovernanceChainSCMgmtActivationAction.sol#L48)

```solidity
File: governance/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/L1SCMgmtActivationAction.sol

30:     function perform() external {

```

[30](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/L1SCMgmtActivationAction.sol#L30)

```solidity
File: governance/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/NonGovernanceChainSCMgmtActivationAction.sol

25:     function perform() external {

```

[25](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/NonGovernanceChainSCMgmtActivationAction.sol#L25)

```solidity
File: governance/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/SecurityCouncilMgmtUpgradeLib.sol

52:     function areAddressArraysEqual(address[] memory array1, address[] memory array2)
53:            public
54:            pure
55:            returns (bool)
56:        {

```

[52-56](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/SecurityCouncilMgmtUpgradeLib.sol#L52-L56)

```solidity
File: governance/src/gov-action-contracts/execution-record/ActionExecutionRecord.sol

37:     function computeKey(uint256 key) public view returns (uint256) {

```

[37](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/execution-record/ActionExecutionRecord.sol#L37)

```solidity
File: governance/src/gov-action-contracts/execution-record/KeyValueStore.sol

11:     function set(uint256 key, uint256 value) external {

16:     function get(uint256 key) external view returns (uint256) {

21:     function get(address owner, uint256 key) external view returns (uint256) {

26:     function computeKey(address owner, uint256 key) public pure returns (uint256) {

```

[11](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/execution-record/KeyValueStore.sol#L11), [16](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/execution-record/KeyValueStore.sol#L16), [21](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/execution-record/KeyValueStore.sol#L21), [26](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/execution-record/KeyValueStore.sol#L26)

```solidity
File: governance/src/security-council-mgmt/SecurityCouncilManager.sol

89:     function initialize(
90:            address[] memory _firstCohort,
91:            address[] memory _secondCohort,
92:            SecurityCouncilData[] memory _securityCouncils,
93:            SecurityCouncilManagerRoles memory _roles,
94:            address payable _l2CoreGovTimelock,
95:            UpgradeExecRouteBuilder _router
96:        ) external initializer {

124:     function replaceCohort(address[] memory _newCohort, Cohort _cohort)
125:             external
126:             onlyRole(COHORT_REPLACER_ROLE)
127:         {

176:     function addMember(address _newMember, Cohort _cohort) external onlyRole(MEMBER_ADDER_ROLE) {

183:     function removeMember(address _member) external onlyRole(MEMBER_REMOVER_ROLE) {

193:     function replaceMember(address _memberToReplace, address _newMember)
194:             external
195:             onlyRole(MEMBER_REPLACER_ROLE)
196:         {

206:     function rotateMember(address _currentAddress, address _newAddress)
207:             external
208:             onlyRole(MEMBER_ROTATOR_ROLE)
209:         {

271:     function addSecurityCouncil(SecurityCouncilData memory _securityCouncilData)
272:             external
273:             onlyRole(DEFAULT_ADMIN_ROLE)
274:         {

279:     function removeSecurityCouncil(SecurityCouncilData memory _securityCouncilData)
280:             external
281:             onlyRole(DEFAULT_ADMIN_ROLE)
282:             returns (bool)
283:         {

308:     function setUpgradeExecRouteBuilder(UpgradeExecRouteBuilder _router)
309:             external
310:             onlyRole(DEFAULT_ADMIN_ROLE)
311:         {

327:     function getFirstCohort() external view returns (address[] memory) {

332:     function getSecondCohort() external view returns (address[] memory) {

337:     function getBothCohorts() public view returns (address[] memory) {

349:     function securityCouncilsLength() public view returns (uint256) {

354:     function firstCohortIncludes(address account) public view returns (bool) {

359:     function secondCohortIncludes(address account) public view returns (bool) {

364:     function cohortIncludes(Cohort cohort, address account) public view returns (bool) {

370:     function generateSalt(address[] memory _members, uint256 nonce)
371:             external
372:             pure
373:             returns (bytes32)
374:         {

379:     function getScheduleUpdateInnerData(uint256 nonce)
380:             public
381:             view
382:             returns (address[] memory, address, bytes memory)
383:         {

```

[89-96](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L89-L96), [124-127](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L124-L127), [176](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L176), [183](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L183), [193-196](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L193-L196), [206-209](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L206-L209), [271-274](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L271-L274), [279-283](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L279-L283), [308-311](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L308-L311), [327](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L327), [332](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L332), [337](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L337), [349](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L349), [354](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L354), [359](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L359), [364](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L364), [370-374](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L370-L374), [379-383](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L379-L383)

```solidity
File: governance/src/security-council-mgmt/SecurityCouncilMemberSyncAction.sol

31:     function perform(address _securityCouncil, address[] memory _updatedMembers, uint256 _nonce)
32:            external
33:            returns (bool res)
34:        {

97:     function getPrevOwner(IGnosisSafe securityCouncil, address _owner)
98:            public
99:            view
100:            returns (address)
101:        {

118:     function getUpdateNonce(address securityCouncil) public view returns (uint256) {

```

[31-34](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilMemberSyncAction.sol#L31-L34), [97-101](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilMemberSyncAction.sol#L97-L101), [118](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilMemberSyncAction.sol#L118)

```solidity
File: governance/src/security-council-mgmt/factories/L2SecurityCouncilMgmtFactory.sol

81:     function deploy(DeployParams memory dp, ContractImplementations memory impls)
82:            external
83:            onlyOwner
84:            returns (DeployedContracts memory)
85:        {

```

[81-85](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/factories/L2SecurityCouncilMgmtFactory.sol#L81-L85)

```solidity
File: governance/src/security-council-mgmt/governors/SecurityCouncilMemberElectionGovernor.sol

48:     function initialize(
49:            ISecurityCouncilNomineeElectionGovernor _nomineeElectionGovernor,
50:            ISecurityCouncilManager _securityCouncilManager,
51:            IVotesUpgradeable _token,
52:            address _owner,
53:            uint256 _votingPeriod,
54:            uint256 _fullWeightDuration
55:        ) public initializer {

86:     function proposeFromNomineeElectionGovernor(uint256 electionIndex)
87:            external
88:            onlyNomineeElectionGovernor
89:            returns (uint256)
90:        {

```

[48-55](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberElectionGovernor.sol#L48-L55), [86-90](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberElectionGovernor.sol#L86-L90)

```solidity
File: governance/src/security-council-mgmt/governors/SecurityCouncilMemberRemovalGovernor.sol

58:     function initialize(
59:            uint256 _voteSuccessNumerator,
60:            ISecurityCouncilManager _securityCouncilManager,
61:            IVotesUpgradeable _token,
62:            address _owner,
63:            uint256 _votingDelay,
64:            uint256 _votingPeriod,
65:            uint256 _quorumNumerator,
66:            uint256 _proposalThreshold,
67:            uint64 _minPeriodAfterQuorum,
68:            uint256 _proposalExpirationBlocks
69:        ) public initializer {

90:     function separateSelector(bytes calldata calldataWithSelector)
91:            external
92:            pure
93:            returns (bytes4, bytes memory)
94:        {

178:     function setVoteSuccessNumerator(uint256 _voteSuccessNumerator) public onlyOwner {

```

[58-69](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberRemovalGovernor.sol#L58-L69), [90-94](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberRemovalGovernor.sol#L90-L94), [178](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberRemovalGovernor.sol#L178)

```solidity
File: governance/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol

103:     function initialize(InitParams memory params) public initializer {

161:     function createElection() external returns (uint256 proposalId) {

218:     function addContender(uint256 proposalId) external {

246:     function setNomineeVetter(address _nomineeVetter) external onlyGovernance {

266:     function excludeNominee(uint256 proposalId, address nominee)
267:             external
268:             onlyNomineeVetter
269:             onlyVettingPeriod(proposalId)
270:         {

290:     function includeNominee(uint256 proposalId, address account) external onlyNomineeVetter {

368:     function isCompliantNominee(uint256 proposalId, address account) public view returns (bool) {

373:     function compliantNominees(uint256 proposalId) public view returns (address[] memory) {

383:     function compliantNomineeCount(uint256 proposalId) public view returns (uint256) {

388:     function currentCohort() public view returns (Cohort) {

394:     function otherCohort() public view returns (Cohort) {

400:     function isExcluded(uint256 proposalId, address possibleExcluded) public view returns (bool) {

405:     function excludedNomineeCount(uint256 proposalId) public view returns (uint256) {

```

[103](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol#L103), [161](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol#L161), [218](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol#L218), [246](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol#L246), [266-270](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol#L266-L270), [290](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol#L290), [368](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol#L368), [373](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol#L373), [383](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol#L383), [388](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol#L388), [394](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol#L394), [400](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol#L400), [405](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol#L405)

```solidity
File: governance/src/security-council-mgmt/governors/modules/ArbitrumGovernorVotesQuorumFractionUpgradeable.sol

32:     function getPastCirculatingSupply(uint256 blockNumber) public view virtual returns (uint256) {

```

[32](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/ArbitrumGovernorVotesQuorumFractionUpgradeable.sol#L32)

```solidity
File: governance/src/security-council-mgmt/governors/modules/ElectionGovernor.sol

16:     function getProposeArgs(uint256 electionIndex)
17:            public
18:            pure
19:            returns (address[] memory, uint256[] memory, bytes[] memory, string memory)
20:        {

40:     function electionIndexToDescription(uint256 electionIndex)
41:            public
42:            pure
43:            returns (string memory)
44:        {

50:     function electionIndexToCohort(uint256 electionIndex) public pure returns (Cohort) {

```

[16-20](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/ElectionGovernor.sol#L16-L20), [40-44](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/ElectionGovernor.sol#L40-L44), [50](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/ElectionGovernor.sol#L50)

```solidity
File: governance/src/security-council-mgmt/governors/modules/SecurityCouncilMemberElectionGovernorCountingUpgradeable.sol

77:     function setFullWeightDuration(uint256 newFullWeightDuration) public onlyGovernance {

148:     function votesUsed(uint256 proposalId, address account) public view returns (uint256) {

153:     function weightReceived(uint256 proposalId, address nominee) public view returns (uint256) {

164:     function fullWeightVotingDeadline(uint256 proposalId) public view returns (uint256) {

177:     function topNominees(uint256 proposalId) public view returns (address[] memory) {

191:     function selectTopNominees(address[] memory nominees, uint240[] memory weights, uint256 k)
192:             public
193:             pure
194:             returns (address[] memory)
195:         {

225:     function votesToWeight(uint256 proposalId, uint256 blockNumber, uint256 votes)
226:             public
227:             view
228:             returns (uint240)
229:         {

```

[77](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilMemberElectionGovernorCountingUpgradeable.sol#L77), [148](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilMemberElectionGovernorCountingUpgradeable.sol#L148), [153](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilMemberElectionGovernorCountingUpgradeable.sol#L153), [164](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilMemberElectionGovernorCountingUpgradeable.sol#L164), [177](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilMemberElectionGovernorCountingUpgradeable.sol#L177), [191-195](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilMemberElectionGovernorCountingUpgradeable.sol#L191-L195), [225-229](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilMemberElectionGovernorCountingUpgradeable.sol#L225-L229)

```solidity
File: governance/src/security-council-mgmt/governors/modules/SecurityCouncilNomineeElectionGovernorCountingUpgradeable.sol

138:     function isNominee(uint256 proposalId, address contender) public view returns (bool) {

143:     function nomineeCount(uint256 proposalId) public view returns (uint256) {

148:     function nominees(uint256 proposalId) public view returns (address[] memory) {

153:     function votesUsed(uint256 proposalId, address account) public view returns (uint256) {

158:     function votesReceived(uint256 proposalId, address contender) public view returns (uint256) {

163:     function isContender(uint256 proposalId, address possibleContender)

```

[138](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilNomineeElectionGovernorCountingUpgradeable.sol#L138), [143](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilNomineeElectionGovernorCountingUpgradeable.sol#L143), [148](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilNomineeElectionGovernorCountingUpgradeable.sol#L148), [153](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilNomineeElectionGovernorCountingUpgradeable.sol#L153), [158](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilNomineeElectionGovernorCountingUpgradeable.sol#L158), [163](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilNomineeElectionGovernorCountingUpgradeable.sol#L163)

```solidity
File: governance/src/security-council-mgmt/governors/modules/SecurityCouncilNomineeElectionGovernorTiming.sol

69:     function proposalVettingDeadline(uint256 proposalId) public view returns (uint256) {

75:     function electionToTimestamp(uint256 electionIndex) public view returns (uint256) {

```

[69](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilNomineeElectionGovernorTiming.sol#L69), [75](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilNomineeElectionGovernorTiming.sol#L75)

</details>

### <a name="N-17"></a>[N-17] Function definition modifier order does not follow Solidity style guide
See [this](https://docs.soliditylang.org/en/v0.8.19/style-guide.html#function-declaration) section of the Solidity Style Guide

*Instances (1)*:

```solidity
File: governance/src/security-council-mgmt/SecurityCouncilManager.sol

/// @audit  1. Mutability before Visibility
89:     function initialize(
90:            address[] memory _firstCohort,
91:            address[] memory _secondCohort,
92:            SecurityCouncilData[] memory _securityCouncils,
93:            SecurityCouncilManagerRoles memory _roles,
94:            address payable _l2CoreGovTimelock,
95:            UpgradeExecRouteBuilder _router
96:        ) external initializer {

```

[89-96](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L89-L96)

### <a name="N-18"></a>[N-18] Function names should differ to make the code more readable
In Solidity, while function overriding allows for functions with the same name to coexist, it is advisable to avoid this practice to enhance code readability and maintainability. Having multiple functions with the same name, even with different parameters or in inherited contracts, can cause confusion and increase the likelihood of errors during development, testing, and debugging. Using distinct and descriptive function names not only clarifies the purpose and behavior of each function, but also helps prevent unintended function calls or incorrect overriding. By adopting a clear and consistent naming convention, developers can create more comprehensible and maintainable smart contracts.

*Instances (1)*:

```solidity
File: governance/src/gov-action-contracts/execution-record/KeyValueStore.sol

/// @audit function name used on lines  16
21:     function get(address owner, uint256 key) external view returns (uint256) {

```

[21](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/execution-record/KeyValueStore.sol#L21)

### <a name="N-19"></a>[N-19] Hardcoded `address` should be avoided
It's better to declare the hardcoded addresses as immutable state variables, as this will facilitate deployment on other chains.

*Instances (4)*:

```solidity
File: governance/src/UpgradeExecRouteBuilder.sol

47:     address public constant RETRYABLE_TICKET_MAGIC = 0xa723C008e76E379c55599D2E4d93879BeaFDa79C;

```

[47](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/UpgradeExecRouteBuilder.sol#L47)

```solidity
File: governance/src/security-council-mgmt/SecurityCouncilManager.sol

77:     address public constant RETRYABLE_TICKET_MAGIC = 0xa723C008e76E379c55599D2E4d93879BeaFDa79C;

```

[77](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L77)

```solidity
File: governance/src/security-council-mgmt/SecurityCouncilMemberSyncAction.sol

19:     address public constant SENTINEL_OWNERS = address(0x1);

```

[19](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilMemberSyncAction.sol#L19)

```solidity
File: governance/src/security-council-mgmt/governors/modules/ArbitrumGovernorVotesQuorumFractionUpgradeable.sol

22:     address public constant EXCLUDE_ADDRESS = address(0xA4b86);

```

[22](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/ArbitrumGovernorVotesQuorumFractionUpgradeable.sol#L22)

### <a name="N-20"></a>[N-20] Use uppercase and underscore for `immutable`s
For immutable variables in Solidity, the convention is to use CAPS_CASE or UPPER_CASE_WITH_UNDERSCORES.

*Instances (21)*:
<details>
<summary>see instances</summary>


```solidity
File: governance/src/UpgradeExecRouteBuilder.sol

57:     address public immutable l1TimelockAddr;

60:     uint256 public immutable l1TimelockMinDelay;

```

[57](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/UpgradeExecRouteBuilder.sol#L57), [60](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/UpgradeExecRouteBuilder.sol#L60)

```solidity
File: governance/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/GovernanceChainSCMgmtActivationAction.sol

13:     IGnosisSafe public immutable newEmergencySecurityCouncil;

14:     IGnosisSafe public immutable newNonEmergencySecurityCouncil;

16:     IGnosisSafe public immutable prevEmergencySecurityCouncil;

17:     IGnosisSafe public immutable prevNonEmergencySecurityCouncil;

19:     uint256 public immutable emergencySecurityCouncilThreshold;

20:     uint256 public immutable nonEmergencySecurityCouncilThreshold;

22:     address public immutable securityCouncilManager;

23:     IL2AddressRegistry public immutable l2AddressRegistry;

```

[13](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/GovernanceChainSCMgmtActivationAction.sol#L13), [14](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/GovernanceChainSCMgmtActivationAction.sol#L14), [16](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/GovernanceChainSCMgmtActivationAction.sol#L16), [17](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/GovernanceChainSCMgmtActivationAction.sol#L17), [19](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/GovernanceChainSCMgmtActivationAction.sol#L19), [20](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/GovernanceChainSCMgmtActivationAction.sol#L20), [22](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/GovernanceChainSCMgmtActivationAction.sol#L22), [23](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/GovernanceChainSCMgmtActivationAction.sol#L23)

```solidity
File: governance/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/L1SCMgmtActivationAction.sol

10:     IGnosisSafe public immutable newEmergencySecurityCouncil;

11:     IGnosisSafe public immutable prevEmergencySecurityCouncil;

12:     uint256 public immutable emergencySecurityCouncilThreshold;

13:     IUpgradeExecutor public immutable l1UpgradeExecutor;

14:     ICoreTimelock public immutable l1Timelock;

```

[10](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/L1SCMgmtActivationAction.sol#L10), [11](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/L1SCMgmtActivationAction.sol#L11), [12](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/L1SCMgmtActivationAction.sol#L12), [13](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/L1SCMgmtActivationAction.sol#L13), [14](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/L1SCMgmtActivationAction.sol#L14)

```solidity
File: governance/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/NonGovernanceChainSCMgmtActivationAction.sol

8:     IGnosisSafe public immutable newEmergencySecurityCouncil;

9:     IGnosisSafe public immutable prevEmergencySecurityCouncil;

10:     uint256 public immutable emergencySecurityCouncilThreshold;

11:     IUpgradeExecutor public immutable upgradeExecutor;

```

[8](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/NonGovernanceChainSCMgmtActivationAction.sol#L8), [9](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/NonGovernanceChainSCMgmtActivationAction.sol#L9), [10](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/NonGovernanceChainSCMgmtActivationAction.sol#L10), [11](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/NonGovernanceChainSCMgmtActivationAction.sol#L11)

```solidity
File: governance/src/gov-action-contracts/execution-record/ActionExecutionRecord.sol

13:     KeyValueStore public immutable store;

16:     bytes32 public immutable actionContractId;

```

[13](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/execution-record/ActionExecutionRecord.sol#L13), [16](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/execution-record/ActionExecutionRecord.sol#L16)

</details>

### <a name="N-21"></a>[N-21] Imports could be organized more systematically
The contract's interface should be imported first, followed by each of the interfaces it uses, followed by all other files. The examples below do not follow this layout.

*Instances (14)*:
<details>
<summary>see instances</summary>


```solidity
File: governance/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/GovernanceChainSCMgmtActivationAction.sol

1: // SPDX-License-Identifier: Apache-2.0

6: import "./SecurityCouncilMgmtUpgradeLib.sol";

```

[1](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/GovernanceChainSCMgmtActivationAction.sol#L1), [6](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/GovernanceChainSCMgmtActivationAction.sol#L6)

```solidity
File: governance/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/L1SCMgmtActivationAction.sol

1: // SPDX-License-Identifier: Apache-2.0

```

[1](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/L1SCMgmtActivationAction.sol#L1)

```solidity
File: governance/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/NonGovernanceChainSCMgmtActivationAction.sol

1: // SPDX-License-Identifier: Apache-2.0

```

[1](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/NonGovernanceChainSCMgmtActivationAction.sol#L1)

```solidity
File: governance/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/SecurityCouncilMgmtUpgradeLib.sol

1: // SPDX-License-Identifier: Apache-2.0

```

[1](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/SecurityCouncilMgmtUpgradeLib.sol#L1)

```solidity
File: governance/src/security-council-mgmt/SecurityCouncilManager.sol

7: import "./SecurityCouncilMgmtUtils.sol";

10: import "../UpgradeExecRouteBuilder.sol";

```

[7](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L7), [10](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L10)

```solidity
File: governance/src/security-council-mgmt/SecurityCouncilMemberSyncAction.sol

1: // SPDX-License-Identifier: Apache-2.0

```

[1](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilMemberSyncAction.sol#L1)

```solidity
File: governance/src/security-council-mgmt/factories/L2SecurityCouncilMgmtFactory.sol

10: import "@openzeppelin/contracts/proxy/transparent/TransparentUpgradeableProxy.sol";

13: import "../../ArbitrumTimelock.sol";

```

[10](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/factories/L2SecurityCouncilMgmtFactory.sol#L10), [13](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/factories/L2SecurityCouncilMgmtFactory.sol#L13)

```solidity
File: governance/src/security-council-mgmt/governors/SecurityCouncilMemberElectionGovernor.sol

7: import "./modules/SecurityCouncilMemberElectionGovernorCountingUpgradeable.sol";

```

[7](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberElectionGovernor.sol#L7)

```solidity
File: governance/src/security-council-mgmt/governors/SecurityCouncilMemberRemovalGovernor.sol

9: import "@openzeppelin/contracts-upgradeable/access/OwnableUpgradeable.sol";

```

[9](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberRemovalGovernor.sol#L9)

```solidity
File: governance/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol

5: import "@openzeppelin/contracts-upgradeable/access/OwnableUpgradeable.sol";

```

[5](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol#L5)

```solidity
File: governance/src/security-council-mgmt/governors/modules/SecurityCouncilNomineeElectionGovernorTiming.sol

1: // SPDX-License-Identifier: Apache-2.0

```

[1](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilNomineeElectionGovernorTiming.sol#L1)

</details>

### <a name="N-22"></a>[N-22] Erorr declaration should include NatSpec documentation
erorrs should be commented to explain their purpose.

*Instances (55)*:
<details>
<summary>see instances</summary>


```solidity
File: governance/src/UpgradeExecRouteBuilder.sol

40:     error UpgadeExecDoesntExist(uint256 chainId);

41:     error UpgradeExecAlreadyExists(uint256 chindId);

42:     error ParamLengthMismatch(uint256 len1, uint256 len2);

43:     error EmptyActionBytesData(bytes[]);

```

[40](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/UpgradeExecRouteBuilder.sol#L40), [41](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/UpgradeExecRouteBuilder.sol#L41), [42](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/UpgradeExecRouteBuilder.sol#L42), [43](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/UpgradeExecRouteBuilder.sol#L43)

```solidity
File: governance/src/security-council-mgmt/Common.sol

20: error ZeroAddress();

21: error NotAContract(address account);

```

[20](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/Common.sol#L20), [21](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/Common.sol#L21)

```solidity
File: governance/src/security-council-mgmt/SecurityCouncilMemberSyncAction.sol

11:     error PreviousOwnerNotFound(address targetOwner, address securityCouncil);

12:     error ExecFromModuleError(bytes data, address securityCouncil);

```

[11](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilMemberSyncAction.sol#L11), [12](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilMemberSyncAction.sol#L12)

```solidity
File: governance/src/security-council-mgmt/factories/L2SecurityCouncilMgmtFactory.sol

67:     error AddressNotInCouncil(address[] securityCouncil, address account);

68:     error InvalidCohortsSize(uint256 councilSize, uint256 firstCohortSize, uint256 secondCohortSize);

```

[67](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/factories/L2SecurityCouncilMgmtFactory.sol#L67), [68](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/factories/L2SecurityCouncilMgmtFactory.sol#L68)

```solidity
File: governance/src/security-council-mgmt/governors/SecurityCouncilMemberElectionGovernor.sol

33:     error InvalidDurations(uint256 fullWeightDuration, uint256 votingPeriod);

34:     error OnlyNomineeElectionGovernor();

35:     error ProposeDisabled();

36:     error CastVoteDisabled();

```

[33](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberElectionGovernor.sol#L33), [34](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberElectionGovernor.sol#L34), [35](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberElectionGovernor.sol#L35), [36](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberElectionGovernor.sol#L36)

```solidity
File: governance/src/security-council-mgmt/governors/SecurityCouncilMemberRemovalGovernor.sol

35:     error InvalidOperationsLength(uint256 len);

36:     error TargetNotManager(address target);

37:     error ValueNotZero(uint256 value);

38:     error UnexpectedCalldataLength(uint256 len);

39:     error CallNotRemoveMember(bytes4 selector, bytes4 expectedSelector);

40:     error MemberNotFound(address memberToRemove);

41:     error AbstainDisallowed();

42:     error InvalidVoteSuccessNumerator(uint256 voteSuccessNumerator);

```

[35](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberRemovalGovernor.sol#L35), [36](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberRemovalGovernor.sol#L36), [37](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberRemovalGovernor.sol#L37), [38](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberRemovalGovernor.sol#L38), [39](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberRemovalGovernor.sol#L39), [40](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberRemovalGovernor.sol#L40), [41](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberRemovalGovernor.sol#L41), [42](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberRemovalGovernor.sol#L42)

```solidity
File: governance/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol

80:     error OnlyNomineeVetter();

81:     error CreateTooEarly(uint256 blockTimestamp, uint256 startTime);

82:     error AlreadyContender(address contender);

83:     error ProposalNotActive(ProposalState state);

84:     error AccountInOtherCohort(Cohort cohort, address account);

85:     error ProposalNotSucceededState(ProposalState state);

86:     error ProposalNotInVettingPeriod(uint256 blockNumber, uint256 vettingDeadline);

87:     error NomineeAlreadyExcluded(address nominee);

88:     error CompliantNomineeTargetHit(uint256 nomineeCount, uint256 expectedCount);

89:     error ProposalInVettingPeriod(uint256 blockNumber, uint256 vettingDeadline);

90:     error InsufficientCompliantNomineeCount(uint256 compliantNomineeCount, uint256 expectedCount);

91:     error ProposeDisabled();

92:     error NotNominee(address nominee);

93:     error ProposalIdMismatch(uint256 nomineeProposalId, uint256 memberProposalId);

94:     error QuorumNumeratorTooLow(uint256 quorumNumeratorValue);

95:     error CastVoteDisabled();

96:     error LastMemberElectionNotExecuted(uint256 prevProposalId);

```

[80](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol#L80), [81](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol#L81), [82](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol#L82), [83](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol#L83), [84](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol#L84), [85](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol#L85), [86](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol#L86), [87](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol#L87), [88](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol#L88), [89](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol#L89), [90](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol#L90), [91](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol#L91), [92](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol#L92), [93](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol#L93), [94](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol#L94), [95](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol#L95), [96](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol#L96)

```solidity
File: governance/src/security-council-mgmt/governors/modules/SecurityCouncilMemberElectionGovernorCountingUpgradeable.sol

55:     error FullWeightDurationGreaterThanVotingPeriod(

58:     error UnexpectedParamsLength(uint256 paramLength);

59:     error NotCompliantNominee(address nominee);

60:     error ZeroWeightVote(uint256 blockNumber, uint256 votes);

61:     error InsufficientVotes(uint256 prevVotesUsed, uint256 votes, uint256 availableVotes);

62:     error LengthsDontMatch(uint256 nomineesLength, uint256 weightsLength);

63:     error NotEnoughNominees(uint256 numNominees, uint256 k);

64:     error UintTooLarge(uint256 x);

65:     error InvalidSupport(uint8 support);

```

[55](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilMemberElectionGovernorCountingUpgradeable.sol#L55), [58](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilMemberElectionGovernorCountingUpgradeable.sol#L58), [59](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilMemberElectionGovernorCountingUpgradeable.sol#L59), [60](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilMemberElectionGovernorCountingUpgradeable.sol#L60), [61](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilMemberElectionGovernorCountingUpgradeable.sol#L61), [62](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilMemberElectionGovernorCountingUpgradeable.sol#L62), [63](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilMemberElectionGovernorCountingUpgradeable.sol#L63), [64](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilMemberElectionGovernorCountingUpgradeable.sol#L64), [65](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilMemberElectionGovernorCountingUpgradeable.sol#L65)

```solidity
File: governance/src/security-council-mgmt/governors/modules/SecurityCouncilNomineeElectionGovernorCountingUpgradeable.sol

46:     error UnexpectedParamsLength(uint256 paramLength);

47:     error NotEligibleContender(address contender);

48:     error NomineeAlreadyAdded(address nominee);

49:     error InsufficientTokens(uint256 votes, uint256 prevVotesUsed, uint256 weight);

50:     error InvalidSupport(uint8 support);

```

[46](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilNomineeElectionGovernorCountingUpgradeable.sol#L46), [47](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilNomineeElectionGovernorCountingUpgradeable.sol#L47), [48](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilNomineeElectionGovernorCountingUpgradeable.sol#L48), [49](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilNomineeElectionGovernorCountingUpgradeable.sol#L49), [50](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilNomineeElectionGovernorCountingUpgradeable.sol#L50)

```solidity
File: governance/src/security-council-mgmt/governors/modules/SecurityCouncilNomineeElectionGovernorTiming.sol

23:     error InvalidStartDate(uint256 year, uint256 month, uint256 day, uint256 hour);

24:     error StartDateTooEarly(uint256 startTime, uint256 currentTime);

```

[23](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilNomineeElectionGovernorTiming.sol#L23), [24](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilNomineeElectionGovernorTiming.sol#L24)

</details>

### <a name="N-23"></a>[N-23] Event declaration should include NatSpec documentation
Events should be commented to explain their purpose.

*Instances (16)*:
<details>
<summary>see instances</summary>


```solidity
File: governance/src/security-council-mgmt/SecurityCouncilManager.sol

33:     event CohortReplaced(address[] newCohort, Cohort indexed cohort);

34:     event MemberAdded(address indexed newMember, Cohort indexed cohort);

35:     event MemberRemoved(address indexed member, Cohort indexed cohort);

36:     event MemberReplaced(address indexed replacedMember, address indexed newMember, Cohort cohort);

37:     event MemberRotated(address indexed replacedAddress, address indexed newAddress, Cohort cohort);

38:     event SecurityCouncilAdded(

41:     event SecurityCouncilRemoved(

44:     event UpgradeExecRouteBuilderSet(address UpgradeExecRouteBuilder);

```

[33](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L33), [34](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L34), [35](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L35), [36](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L36), [37](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L37), [38](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L38), [41](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L41), [44](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L44)

```solidity
File: governance/src/security-council-mgmt/SecurityCouncilMemberSyncAction.sol

14:     event UpdateNonceTooLow(

```

[14](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilMemberSyncAction.sol#L14)

```solidity
File: governance/src/security-council-mgmt/factories/L2SecurityCouncilMgmtFactory.sol

56:     event ContractsDeployed(DeployedContracts deployedContracts);

```

[56](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/factories/L2SecurityCouncilMgmtFactory.sol#L56)

```solidity
File: governance/src/security-council-mgmt/governors/SecurityCouncilMemberRemovalGovernor.sol

32:     event VoteSuccessNumeratorSet(uint256 indexed voteSuccessNumerator);

33:     event MemberRemovalProposed(address memberToRemove, string description);

```

[32](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberRemovalGovernor.sol#L32), [33](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberRemovalGovernor.sol#L33)

```solidity
File: governance/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol

76:     event NomineeVetterChanged(address indexed oldNomineeVetter, address indexed newNomineeVetter);

77:     event ContenderAdded(uint256 indexed proposalId, address indexed contender);

78:     event NomineeExcluded(uint256 indexed proposalId, address indexed nominee);

```

[76](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol#L76), [77](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol#L77), [78](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol#L78)

```solidity
File: governance/src/security-council-mgmt/governors/modules/SecurityCouncilNomineeElectionGovernorCountingUpgradeable.sol

44:     event NewNominee(uint256 indexed proposalId, address indexed nominee);

```

[44](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilNomineeElectionGovernorCountingUpgradeable.sol#L44)

</details>

### <a name="N-24"></a>[N-24] State variable declaration should include NatSpec documentation
State variables should be commented to explain their purpose.

*Instances (30)*:
<details>
<summary>see instances</summary>


```solidity
File: governance/src/UpgradeExecRouteBuilder.sol

52:     uint256 public constant DEFAULT_VALUE = 0;

```

[52](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/UpgradeExecRouteBuilder.sol#L52)

```solidity
File: governance/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/GovernanceChainSCMgmtActivationAction.sol

13:     IGnosisSafe public immutable newEmergencySecurityCouncil;

14:     IGnosisSafe public immutable newNonEmergencySecurityCouncil;

16:     IGnosisSafe public immutable prevEmergencySecurityCouncil;

17:     IGnosisSafe public immutable prevNonEmergencySecurityCouncil;

19:     uint256 public immutable emergencySecurityCouncilThreshold;

20:     uint256 public immutable nonEmergencySecurityCouncilThreshold;

22:     address public immutable securityCouncilManager;

23:     IL2AddressRegistry public immutable l2AddressRegistry;

```

[13](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/GovernanceChainSCMgmtActivationAction.sol#L13), [14](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/GovernanceChainSCMgmtActivationAction.sol#L14), [16](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/GovernanceChainSCMgmtActivationAction.sol#L16), [17](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/GovernanceChainSCMgmtActivationAction.sol#L17), [19](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/GovernanceChainSCMgmtActivationAction.sol#L19), [20](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/GovernanceChainSCMgmtActivationAction.sol#L20), [22](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/GovernanceChainSCMgmtActivationAction.sol#L22), [23](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/GovernanceChainSCMgmtActivationAction.sol#L23)

```solidity
File: governance/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/L1SCMgmtActivationAction.sol

10:     IGnosisSafe public immutable newEmergencySecurityCouncil;

11:     IGnosisSafe public immutable prevEmergencySecurityCouncil;

12:     uint256 public immutable emergencySecurityCouncilThreshold;

13:     IUpgradeExecutor public immutable l1UpgradeExecutor;

14:     ICoreTimelock public immutable l1Timelock;

```

[10](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/L1SCMgmtActivationAction.sol#L10), [11](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/L1SCMgmtActivationAction.sol#L11), [12](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/L1SCMgmtActivationAction.sol#L12), [13](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/L1SCMgmtActivationAction.sol#L13), [14](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/L1SCMgmtActivationAction.sol#L14)

```solidity
File: governance/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/NonGovernanceChainSCMgmtActivationAction.sol

8:     IGnosisSafe public immutable newEmergencySecurityCouncil;

9:     IGnosisSafe public immutable prevEmergencySecurityCouncil;

10:     uint256 public immutable emergencySecurityCouncilThreshold;

11:     IUpgradeExecutor public immutable upgradeExecutor;

```

[8](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/NonGovernanceChainSCMgmtActivationAction.sol#L8), [9](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/NonGovernanceChainSCMgmtActivationAction.sol#L9), [10](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/NonGovernanceChainSCMgmtActivationAction.sol#L10), [11](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/NonGovernanceChainSCMgmtActivationAction.sol#L11)

```solidity
File: governance/src/gov-action-contracts/execution-record/KeyValueStore.sol

7:     mapping(uint256 => uint256) public store;

```

[7](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/execution-record/KeyValueStore.sol#L7)

```solidity
File: governance/src/security-council-mgmt/SecurityCouncilManager.sol

51:     address[] internal firstCohort;

52:     address[] internal secondCohort;

79:     bytes32 public constant COHORT_REPLACER_ROLE = keccak256("COHORT_REPLACER");

80:     bytes32 public constant MEMBER_ADDER_ROLE = keccak256("MEMBER_ADDER");

81:     bytes32 public constant MEMBER_REPLACER_ROLE = keccak256("MEMBER_REPLACER");

82:     bytes32 public constant MEMBER_ROTATOR_ROLE = keccak256("MEMBER_ROTATOR");

83:     bytes32 public constant MEMBER_REMOVER_ROLE = keccak256("MEMBER_REMOVER");

```

[51](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L51), [52](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L52), [79](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L79), [80](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L80), [81](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L81), [82](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L82), [83](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L83)

```solidity
File: governance/src/security-council-mgmt/governors/SecurityCouncilMemberRemovalGovernor.sol

28:     uint256 public constant voteSuccessDenominator = 10_000;

29:     uint256 public voteSuccessNumerator;

30:     ISecurityCouncilManager public securityCouncilManager;

```

[28](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberRemovalGovernor.sol#L28), [29](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberRemovalGovernor.sol#L29), [30](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberRemovalGovernor.sol#L30)

```solidity
File: governance/src/security-council-mgmt/governors/modules/SecurityCouncilNomineeElectionGovernorCountingUpgradeable.sol

26:     mapping(uint256 => NomineeElectionCountingInfo) private _elections;

```

[26](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilNomineeElectionGovernorCountingUpgradeable.sol#L26)

</details>

### <a name="N-25"></a>[N-25] `override` function arguments that are unused should have the variable name removed or commented out to avoid compiler warnings

*Instances (35)*:
<details>
<summary>see instances</summary>


```solidity
File: governance/src/security-council-mgmt/governors/SecurityCouncilMemberElectionGovernor.sol

103:     function relay(address target, uint256 value, bytes calldata data)
104:             external
105:             virtual
106:             override
107:             onlyOwner
108:         {

103:     function relay(address target, uint256 value, bytes calldata data)
104:             external
105:             virtual
106:             override
107:             onlyOwner
108:         {

103:     function relay(address target, uint256 value, bytes calldata data)
104:             external
105:             virtual
106:             override
107:             onlyOwner
108:         {

115:     function _execute(
116:             uint256 proposalId,
117:             address[] memory, /* targets */
118:             uint256[] memory, /* values */
119:             bytes[] memory callDatas,
120:             bytes32 /* descriptionHash */
121:         ) internal override {

115:     function _execute(
116:             uint256 proposalId,
117:             address[] memory, /* targets */
118:             uint256[] memory, /* values */
119:             bytes[] memory callDatas,
120:             bytes32 /* descriptionHash */
121:         ) internal override {

154:     function _isCompliantNominee(uint256 proposalId, address possibleNominee)
155:             internal
156:             view
157:             override
158:             returns (bool)
159:         {

154:     function _isCompliantNominee(uint256 proposalId, address possibleNominee)
155:             internal
156:             view
157:             override
158:             returns (bool)
159:         {

164:     function _compliantNominees(uint256 proposalId)
165:             internal
166:             view
167:             override
168:             returns (address[] memory)
169:         {

```

[103-108](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberElectionGovernor.sol#L103-L108), [103-108](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberElectionGovernor.sol#L103-L108), [103-108](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberElectionGovernor.sol#L103-L108), [115-121](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberElectionGovernor.sol#L115-L121), [115-121](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberElectionGovernor.sol#L115-L121), [154-159](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberElectionGovernor.sol#L154-L159), [154-159](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberElectionGovernor.sol#L154-L159), [164-169](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberElectionGovernor.sol#L164-L169)

```solidity
File: governance/src/security-council-mgmt/governors/SecurityCouncilMemberRemovalGovernor.sol

106:     function propose(
107:             address[] memory targets,
108:             uint256[] memory values,
109:             bytes[] memory calldatas,
110:             string memory description
111:         ) public override returns (uint256) {

106:     function propose(
107:             address[] memory targets,
108:             uint256[] memory values,
109:             bytes[] memory calldatas,
110:             string memory description
111:         ) public override returns (uint256) {

106:     function propose(
107:             address[] memory targets,
108:             uint256[] memory values,
109:             bytes[] memory calldatas,
110:             string memory description
111:         ) public override returns (uint256) {

106:     function propose(
107:             address[] memory targets,
108:             uint256[] memory values,
109:             bytes[] memory calldatas,
110:             string memory description
111:         ) public override returns (uint256) {

147:     function _voteSucceeded(uint256 proposalId)
148:             internal
149:             view
150:             virtual
151:             override(GovernorCountingSimpleUpgradeable, GovernorUpgradeable)
152:             returns (bool)
153:         {

163:     function _countVote(
164:             uint256 proposalId,
165:             address account,
166:             uint8 support,
167:             uint256 weight,
168:             bytes memory params
169:         ) internal virtual override(GovernorCountingSimpleUpgradeable, GovernorUpgradeable) {

163:     function _countVote(
164:             uint256 proposalId,
165:             address account,
166:             uint8 support,
167:             uint256 weight,
168:             bytes memory params
169:         ) internal virtual override(GovernorCountingSimpleUpgradeable, GovernorUpgradeable) {

163:     function _countVote(
164:             uint256 proposalId,
165:             address account,
166:             uint8 support,
167:             uint256 weight,
168:             bytes memory params
169:         ) internal virtual override(GovernorCountingSimpleUpgradeable, GovernorUpgradeable) {

163:     function _countVote(
164:             uint256 proposalId,
165:             address account,
166:             uint8 support,
167:             uint256 weight,
168:             bytes memory params
169:         ) internal virtual override(GovernorCountingSimpleUpgradeable, GovernorUpgradeable) {

163:     function _countVote(
164:             uint256 proposalId,
165:             address account,
166:             uint8 support,
167:             uint256 weight,
168:             bytes memory params
169:         ) internal virtual override(GovernorCountingSimpleUpgradeable, GovernorUpgradeable) {

203:     function relay(address target, uint256 value, bytes calldata data)
204:             external
205:             virtual
206:             override
207:             onlyOwner
208:         {

203:     function relay(address target, uint256 value, bytes calldata data)
204:             external
205:             virtual
206:             override
207:             onlyOwner
208:         {

203:     function relay(address target, uint256 value, bytes calldata data)
204:             external
205:             virtual
206:             override
207:             onlyOwner
208:         {

223:     function _castVote(
224:             uint256 proposalId,
225:             address account,
226:             uint8 support,
227:             string memory reason,
228:             bytes memory params
229:         )
230:             internal
231:             override(GovernorUpgradeable, GovernorPreventLateQuorumUpgradeable)
232:             returns (uint256)
233:         {

223:     function _castVote(
224:             uint256 proposalId,
225:             address account,
226:             uint8 support,
227:             string memory reason,
228:             bytes memory params
229:         )
230:             internal
231:             override(GovernorUpgradeable, GovernorPreventLateQuorumUpgradeable)
232:             returns (uint256)
233:         {

223:     function _castVote(
224:             uint256 proposalId,
225:             address account,
226:             uint8 support,
227:             string memory reason,
228:             bytes memory params
229:         )
230:             internal
231:             override(GovernorUpgradeable, GovernorPreventLateQuorumUpgradeable)
232:             returns (uint256)
233:         {

223:     function _castVote(
224:             uint256 proposalId,
225:             address account,
226:             uint8 support,
227:             string memory reason,
228:             bytes memory params
229:         )
230:             internal
231:             override(GovernorUpgradeable, GovernorPreventLateQuorumUpgradeable)
232:             returns (uint256)
233:         {

223:     function _castVote(
224:             uint256 proposalId,
225:             address account,
226:             uint8 support,
227:             string memory reason,
228:             bytes memory params
229:         )
230:             internal
231:             override(GovernorUpgradeable, GovernorPreventLateQuorumUpgradeable)
232:             returns (uint256)
233:         {

240:     function proposalDeadline(uint256 proposalId)
241:             public
242:             view
243:             override(GovernorUpgradeable, GovernorPreventLateQuorumUpgradeable)
244:             returns (uint256)
245:         {

249:     function state(uint256 proposalId)
250:             public
251:             view
252:             override(ArbitrumGovernorProposalExpirationUpgradeable, GovernorUpgradeable)
253:             returns (ProposalState)
254:         {

```

[106-111](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberRemovalGovernor.sol#L106-L111), [106-111](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberRemovalGovernor.sol#L106-L111), [106-111](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberRemovalGovernor.sol#L106-L111), [106-111](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberRemovalGovernor.sol#L106-L111), [147-153](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberRemovalGovernor.sol#L147-L153), [163-169](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberRemovalGovernor.sol#L163-L169), [163-169](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberRemovalGovernor.sol#L163-L169), [163-169](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberRemovalGovernor.sol#L163-L169), [163-169](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberRemovalGovernor.sol#L163-L169), [163-169](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberRemovalGovernor.sol#L163-L169), [203-208](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberRemovalGovernor.sol#L203-L208), [203-208](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberRemovalGovernor.sol#L203-L208), [203-208](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberRemovalGovernor.sol#L203-L208), [223-233](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberRemovalGovernor.sol#L223-L233), [223-233](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberRemovalGovernor.sol#L223-L233), [223-233](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberRemovalGovernor.sol#L223-L233), [223-233](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberRemovalGovernor.sol#L223-L233), [223-233](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberRemovalGovernor.sol#L223-L233), [240-245](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberRemovalGovernor.sol#L240-L245), [249-254](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberRemovalGovernor.sol#L249-L254)

```solidity
File: governance/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol

254:     function relay(address target, uint256 value, bytes calldata data)
255:             external
256:             virtual
257:             override
258:             onlyOwner
259:         {

254:     function relay(address target, uint256 value, bytes calldata data)
255:             external
256:             virtual
257:             override
258:             onlyOwner
259:         {

254:     function relay(address target, uint256 value, bytes calldata data)
255:             external
256:             virtual
257:             override
258:             onlyOwner
259:         {

324:     function _execute(
325:             uint256 proposalId,
326:             address[] memory, /* targets */
327:             uint256[] memory, /* values */
328:             bytes[] memory callDatas,
329:             bytes32 /*descriptionHash*/
330:         ) internal virtual override {

324:     function _execute(
325:             uint256 proposalId,
326:             address[] memory, /* targets */
327:             uint256[] memory, /* values */
328:             bytes[] memory callDatas,
329:             bytes32 /*descriptionHash*/
330:         ) internal virtual override {

410:     function isContender(uint256 proposalId, address possibleContender)
411:             public
412:             view
413:             virtual
414:             override
415:             returns (bool)
416:         {

410:     function isContender(uint256 proposalId, address possibleContender)
411:             public
412:             view
413:             virtual
414:             override
415:             returns (bool)
416:         {

```

[254-259](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol#L254-L259), [254-259](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol#L254-L259), [254-259](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol#L254-L259), [324-330](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol#L324-L330), [324-330](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol#L324-L330), [410-416](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol#L410-L416), [410-416](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol#L410-L416)

</details>

### <a name="N-26"></a>[N-26] public function names should should use mixedCase
See the [function-names](https://docs.soliditylang.org/en/latest/style-guide.html#function-names) section of solidity dstyle guide

*Instances (3)*:

```solidity
File: governance/src/security-council-mgmt/governors/SecurityCouncilMemberRemovalGovernor.sol

191:     function COUNTING_MODE()

```

[191](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberRemovalGovernor.sol#L191)

```solidity
File: governance/src/security-council-mgmt/governors/modules/SecurityCouncilMemberElectionGovernorCountingUpgradeable.sol

143:     function COUNTING_MODE() public pure virtual override returns (string memory) {

```

[143](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilMemberElectionGovernorCountingUpgradeable.sol#L143)

```solidity
File: governance/src/security-council-mgmt/governors/modules/SecurityCouncilNomineeElectionGovernorCountingUpgradeable.sol

128:     function COUNTING_MODE() public pure virtual override returns (string memory) {

```

[128](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilNomineeElectionGovernorCountingUpgradeable.sol#L128)

### <a name="N-27"></a>[N-27] Unused named `return`
Declaring named returns, but not using them, is confusing to the reader. Consider either completely removing them (by declaring just the type without a name), or remove the return statement and do a variable assignment.
This would improve the readability of the code, and it may also help reduce regressions during future code refactors.

*Instances (2)*:

```solidity
File: governance/src/security-council-mgmt/SecurityCouncilMemberSyncAction.sol

31:     function perform(address _securityCouncil, address[] memory _updatedMembers, uint256 _nonce)
32:            external
33:            returns (bool res)
34:        {

```

[31-34](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilMemberSyncAction.sol#L31-L34)

```solidity
File: governance/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol

161:     function createElection() external returns (uint256 proposalId) {

```

[161](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol#L161)

### <a name="N-28"></a>[N-28] Unusual loop variable
The normal name `for` loop variables is `i`, and when there is a nested `loop`, to use `j`. The code below chooses to use another variable without being nested within another `for`-loop, which may lead to confusion

*Instances (3)*:

```solidity
File: governance/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/SecurityCouncilMgmtUpgradeLib.sol

63:             for (uint256 j = 0; j < array2.length; j++) {

76:             for (uint256 j = 0; j < array1.length; j++) {

```

[63](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/SecurityCouncilMgmtUpgradeLib.sol#L63), [76](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/SecurityCouncilMgmtUpgradeLib.sol#L76)

```solidity
File: governance/src/security-council-mgmt/SecurityCouncilManager.sol

164:             for (uint256 j = 0; j < cohort.length; j++) {

```

[164](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L164)

### <a name="N-29"></a>[N-29] Functions not used internally could be marked external

*Instances (30)*:
<details>
<summary>see instances</summary>


```solidity
File: governance/src/UpgradeExecRouteBuilder.sol

186:     function createActionRouteDataWithDefaults(

```

[186](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/UpgradeExecRouteBuilder.sol#L186)

```solidity
File: governance/src/security-council-mgmt/SecurityCouncilManager.sol

349:     function securityCouncilsLength() public view returns (uint256) {

```

[349](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L349)

```solidity
File: governance/src/security-council-mgmt/governors/SecurityCouncilMemberElectionGovernor.sol

48:     function initialize(

138:     function proposalThreshold()

148:     function quorum(uint256) public pure override returns (uint256) {

```

[48](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberElectionGovernor.sol#L48), [138](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberElectionGovernor.sol#L138), [148](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberElectionGovernor.sol#L148)

```solidity
File: governance/src/security-council-mgmt/governors/SecurityCouncilMemberRemovalGovernor.sol

58:     function initialize(

106:     function propose(

178:     function setVoteSuccessNumerator(uint256 _voteSuccessNumerator) public onlyOwner {

213:     function proposalThreshold()

240:     function proposalDeadline(uint256 proposalId)

249:     function state(uint256 proposalId)

```

[58](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberRemovalGovernor.sol#L58), [106](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberRemovalGovernor.sol#L106), [178](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberRemovalGovernor.sol#L178), [213](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberRemovalGovernor.sol#L213), [240](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberRemovalGovernor.sol#L240), [249](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberRemovalGovernor.sol#L249)

```solidity
File: governance/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol

103:     function initialize(InitParams memory params) public initializer {

368:     function isCompliantNominee(uint256 proposalId, address account) public view returns (bool) {

373:     function compliantNominees(uint256 proposalId) public view returns (address[] memory) {

388:     function currentCohort() public view returns (Cohort) {

400:     function isExcluded(uint256 proposalId, address possibleExcluded) public view returns (bool) {

405:     function excludedNomineeCount(uint256 proposalId) public view returns (uint256) {

```

[103](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol#L103), [368](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol#L368), [373](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol#L373), [388](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol#L388), [400](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol#L400), [405](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol#L405)

```solidity
File: governance/src/security-council-mgmt/governors/modules/ElectionGovernor.sol

16:     function getProposeArgs(uint256 electionIndex)

50:     function electionIndexToCohort(uint256 electionIndex) public pure returns (Cohort) {

```

[16](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/ElectionGovernor.sol#L16), [50](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/ElectionGovernor.sol#L50)

```solidity
File: governance/src/security-council-mgmt/governors/modules/SecurityCouncilMemberElectionGovernorCountingUpgradeable.sol

77:     function setFullWeightDuration(uint256 newFullWeightDuration) public onlyGovernance {

153:     function weightReceived(uint256 proposalId, address nominee) public view returns (uint256) {

158:     function hasVoted(uint256 proposalId, address account) public view override returns (bool) {

177:     function topNominees(uint256 proposalId) public view returns (address[] memory) {

```

[77](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilMemberElectionGovernorCountingUpgradeable.sol#L77), [153](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilMemberElectionGovernorCountingUpgradeable.sol#L153), [158](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilMemberElectionGovernorCountingUpgradeable.sol#L158), [177](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilMemberElectionGovernorCountingUpgradeable.sol#L177)

```solidity
File: governance/src/security-council-mgmt/governors/modules/SecurityCouncilNomineeElectionGovernorCountingUpgradeable.sol

133:     function hasVoted(uint256 proposalId, address account) public view override returns (bool) {

143:     function nomineeCount(uint256 proposalId) public view returns (uint256) {

148:     function nominees(uint256 proposalId) public view returns (address[] memory) {

153:     function votesUsed(uint256 proposalId, address account) public view returns (uint256) {

158:     function votesReceived(uint256 proposalId, address contender) public view returns (uint256) {

```

[133](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilNomineeElectionGovernorCountingUpgradeable.sol#L133), [143](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilNomineeElectionGovernorCountingUpgradeable.sol#L143), [148](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilNomineeElectionGovernorCountingUpgradeable.sol#L148), [153](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilNomineeElectionGovernorCountingUpgradeable.sol#L153), [158](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilNomineeElectionGovernorCountingUpgradeable.sol#L158)

```solidity
File: governance/src/security-council-mgmt/governors/modules/SecurityCouncilNomineeElectionGovernorTiming.sol

69:     function proposalVettingDeadline(uint256 proposalId) public view returns (uint256) {

75:     function electionToTimestamp(uint256 electionIndex) public view returns (uint256) {

```

[69](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilNomineeElectionGovernorTiming.sol#L69), [75](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilNomineeElectionGovernorTiming.sol#L75)

</details>

### <a name="N-30"></a>[N-30] Use a single file for system wide constants
Consider grouping all the system constants under a single file. This finding shows only the first constant for each file, for brevity.

*Instances (13)*:
<details>
<summary>see instances</summary>


```solidity
File: governance/src/UpgradeExecRouteBuilder.sol

47:     address public constant RETRYABLE_TICKET_MAGIC = 0xa723C008e76E379c55599D2E4d93879BeaFDa79C;

50:     bytes public constant DEFAULT_GOV_ACTION_CALLDATA =

52:     uint256 public constant DEFAULT_VALUE = 0;

54:     bytes32 public constant DEFAULT_PREDECESSOR = bytes32(0);

```

[47](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/UpgradeExecRouteBuilder.sol#L47), [50](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/UpgradeExecRouteBuilder.sol#L50), [52](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/UpgradeExecRouteBuilder.sol#L52), [54](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/UpgradeExecRouteBuilder.sol#L54)

```solidity
File: governance/src/security-council-mgmt/SecurityCouncilManager.sol

77:     address public constant RETRYABLE_TICKET_MAGIC = 0xa723C008e76E379c55599D2E4d93879BeaFDa79C;

79:     bytes32 public constant COHORT_REPLACER_ROLE = keccak256("COHORT_REPLACER");

80:     bytes32 public constant MEMBER_ADDER_ROLE = keccak256("MEMBER_ADDER");

81:     bytes32 public constant MEMBER_REPLACER_ROLE = keccak256("MEMBER_REPLACER");

82:     bytes32 public constant MEMBER_ROTATOR_ROLE = keccak256("MEMBER_ROTATOR");

83:     bytes32 public constant MEMBER_REMOVER_ROLE = keccak256("MEMBER_REMOVER");

```

[77](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L77), [79](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L79), [80](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L80), [81](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L81), [82](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L82), [83](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L83)

```solidity
File: governance/src/security-council-mgmt/SecurityCouncilMemberSyncAction.sol

19:     address public constant SENTINEL_OWNERS = address(0x1);

```

[19](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilMemberSyncAction.sol#L19)

```solidity
File: governance/src/security-council-mgmt/governors/SecurityCouncilMemberRemovalGovernor.sol

28:     uint256 public constant voteSuccessDenominator = 10_000;

```

[28](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberRemovalGovernor.sol#L28)

```solidity
File: governance/src/security-council-mgmt/governors/modules/ArbitrumGovernorVotesQuorumFractionUpgradeable.sol

22:     address public constant EXCLUDE_ADDRESS = address(0xA4b86);

```

[22](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/ArbitrumGovernorVotesQuorumFractionUpgradeable.sol#L22)

</details>

### <a name="N-31"></a>[N-31] Using underscore at the end of variable name
The use of underscore at the end of the variable name is uncommon and also suggests that the variable name was not completely changed. Consider refactoring variableName_ to variableName.

*Instances (4)*:

```solidity
File: governance/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol

144:         ProposalState state_ = state(proposalId);

225:         ProposalState state_ = state(proposalId);

291:         ProposalState state_ = state(proposalId);

```

[144](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol#L144), [225](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol#L225), [291](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol#L291)

```solidity
File: governance/src/security-council-mgmt/governors/modules/SecurityCouncilMemberElectionGovernorCountingUpgradeable.sol

242:         uint256 fullWeightVotingDeadline_ = fullWeightVotingDeadline(proposalId);

```

[242](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilMemberElectionGovernorCountingUpgradeable.sol#L242)

### <a name="N-32"></a>[N-32] OpenZeppelin libraries should be upgraded to a newer version
These contracts import some OpenZeppelin libraries, but they are using an old version.

*Instances (1)*:

```solidity
File: package.json

/// @audit path: governance
1: version: 4.7.3

```

[1](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L1)

### <a name="N-33"></a>[N-33] Non-usage of specific imports
The current form of relative path import is not recommended for use because it can unpredictably pollute the namespace. Instead, the Solidity docs recommend specifying imported symbols explicitly. [https://docs.soliditylang.org/en/v0.8.15/layout-of-source-files.html#importing-other-source-files](https://docs.soliditylang.org/en/v0.8.15/layout-of-source-files.html#importing-other-source-files)

*Instances (82)*:
<details>
<summary>see instances</summary>


```solidity
File: governance/src/UpgradeExecRouteBuilder.sol

4: import "@arbitrum/nitro-contracts/src/precompiles/ArbSys.sol";

5: import "./UpgradeExecutor.sol";

6: import "./L1ArbitrumTimelock.sol";

7: import "./security-council-mgmt/Common.sol";

```

[4](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/UpgradeExecRouteBuilder.sol#L4), [5](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/UpgradeExecRouteBuilder.sol#L5), [6](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/UpgradeExecRouteBuilder.sol#L6), [7](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/UpgradeExecRouteBuilder.sol#L7)

```solidity
File: governance/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/GovernanceChainSCMgmtActivationAction.sol

4: import "../../../security-council-mgmt/interfaces/IGnosisSafe.sol";

5: import "../../address-registries/L2AddressRegistryInterfaces.sol";

6: import "./SecurityCouncilMgmtUpgradeLib.sol";

7: import "../../../interfaces/IArbitrumDAOConstitution.sol";

8: import "../../../interfaces/IUpgradeExecutor.sol";

9: import "../../../interfaces/ICoreTimelock.sol";

10: import "@openzeppelin/contracts/utils/Address.sol";

```

[4](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/GovernanceChainSCMgmtActivationAction.sol#L4), [5](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/GovernanceChainSCMgmtActivationAction.sol#L5), [6](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/GovernanceChainSCMgmtActivationAction.sol#L6), [7](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/GovernanceChainSCMgmtActivationAction.sol#L7), [8](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/GovernanceChainSCMgmtActivationAction.sol#L8), [9](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/GovernanceChainSCMgmtActivationAction.sol#L9), [10](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/GovernanceChainSCMgmtActivationAction.sol#L10)

```solidity
File: governance/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/L1SCMgmtActivationAction.sol

4: import "../../../security-council-mgmt/interfaces/IGnosisSafe.sol";

5: import "../../../interfaces/IUpgradeExecutor.sol";

6: import "../../../interfaces/ICoreTimelock.sol";

7: import "./SecurityCouncilMgmtUpgradeLib.sol";

```

[4](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/L1SCMgmtActivationAction.sol#L4), [5](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/L1SCMgmtActivationAction.sol#L5), [6](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/L1SCMgmtActivationAction.sol#L6), [7](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/L1SCMgmtActivationAction.sol#L7)

```solidity
File: governance/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/NonGovernanceChainSCMgmtActivationAction.sol

4: import "../../../security-council-mgmt/interfaces/IGnosisSafe.sol";

5: import "./SecurityCouncilMgmtUpgradeLib.sol";

```

[4](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/NonGovernanceChainSCMgmtActivationAction.sol#L4), [5](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/NonGovernanceChainSCMgmtActivationAction.sol#L5)

```solidity
File: governance/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/SecurityCouncilMgmtUpgradeLib.sol

4: import "../../../security-council-mgmt/interfaces/IGnosisSafe.sol";

5: import "../../../interfaces/IUpgradeExecutor.sol";

```

[4](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/SecurityCouncilMgmtUpgradeLib.sol#L4), [5](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/SecurityCouncilMgmtUpgradeLib.sol#L5)

```solidity
File: governance/src/gov-action-contracts/execution-record/ActionExecutionRecord.sol

4: import "./KeyValueStore.sol";

```

[4](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/execution-record/ActionExecutionRecord.sol#L4)

```solidity
File: governance/src/security-council-mgmt/SecurityCouncilManager.sol

4: import "../ArbitrumTimelock.sol";

5: import "../UpgradeExecutor.sol";

6: import "../L1ArbitrumTimelock.sol";

7: import "./SecurityCouncilMgmtUtils.sol";

8: import "./interfaces/ISecurityCouncilManager.sol";

9: import "./SecurityCouncilMemberSyncAction.sol";

10: import "../UpgradeExecRouteBuilder.sol";

11: import "@openzeppelin/contracts-upgradeable/proxy/utils/Initializable.sol";

12: import "@openzeppelin/contracts/utils/Address.sol";

13: import "@openzeppelin/contracts-upgradeable/access/AccessControlUpgradeable.sol";

14: import "./Common.sol";

```

[4](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L4), [5](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L5), [6](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L6), [7](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L7), [8](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L8), [9](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L9), [10](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L10), [11](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L11), [12](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L12), [13](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L13), [14](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L14)

```solidity
File: governance/src/security-council-mgmt/SecurityCouncilMemberSyncAction.sol

4: import "./interfaces/IGnosisSafe.sol";

5: import "./SecurityCouncilMgmtUtils.sol";

6: import "../gov-action-contracts/execution-record/ActionExecutionRecord.sol";

```

[4](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilMemberSyncAction.sol#L4), [5](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilMemberSyncAction.sol#L5), [6](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilMemberSyncAction.sol#L6)

```solidity
File: governance/src/security-council-mgmt/factories/L2SecurityCouncilMgmtFactory.sol

4: import "@openzeppelin/contracts/access/Ownable.sol";

5: import "@openzeppelin/contracts/utils/Address.sol";

6: import "../governors/SecurityCouncilMemberElectionGovernor.sol";

7: import "../governors/SecurityCouncilNomineeElectionGovernor.sol";

8: import "../SecurityCouncilManager.sol";

9: import "../governors/SecurityCouncilMemberRemovalGovernor.sol";

10: import "@openzeppelin/contracts/proxy/transparent/TransparentUpgradeableProxy.sol";

11: import "../interfaces/ISecurityCouncilManager.sol";

12: import "../interfaces/IGnosisSafe.sol";

13: import "../../ArbitrumTimelock.sol";

14: import "@openzeppelin/contracts-upgradeable/governance/utils/IVotesUpgradeable.sol";

15: import "../../UpgradeExecRouteBuilder.sol";

16: import "../Common.sol";

```

[4](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/factories/L2SecurityCouncilMgmtFactory.sol#L4), [5](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/factories/L2SecurityCouncilMgmtFactory.sol#L5), [6](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/factories/L2SecurityCouncilMgmtFactory.sol#L6), [7](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/factories/L2SecurityCouncilMgmtFactory.sol#L7), [8](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/factories/L2SecurityCouncilMgmtFactory.sol#L8), [9](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/factories/L2SecurityCouncilMgmtFactory.sol#L9), [10](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/factories/L2SecurityCouncilMgmtFactory.sol#L10), [11](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/factories/L2SecurityCouncilMgmtFactory.sol#L11), [12](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/factories/L2SecurityCouncilMgmtFactory.sol#L12), [13](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/factories/L2SecurityCouncilMgmtFactory.sol#L13), [14](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/factories/L2SecurityCouncilMgmtFactory.sol#L14), [15](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/factories/L2SecurityCouncilMgmtFactory.sol#L15), [16](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/factories/L2SecurityCouncilMgmtFactory.sol#L16)

```solidity
File: governance/src/security-council-mgmt/governors/SecurityCouncilMemberElectionGovernor.sol

4: import "@openzeppelin/contracts-upgradeable/governance/extensions/GovernorVotesUpgradeable.sol";

5: import "@openzeppelin/contracts-upgradeable/governance/extensions/GovernorSettingsUpgradeable.sol";

6: import "@openzeppelin/contracts-upgradeable/access/OwnableUpgradeable.sol";

7: import "./modules/SecurityCouncilMemberElectionGovernorCountingUpgradeable.sol";

8: import "../interfaces/ISecurityCouncilMemberElectionGovernor.sol";

9: import "../interfaces/ISecurityCouncilNomineeElectionGovernor.sol";

10: import "../interfaces/ISecurityCouncilManager.sol";

11: import "./modules/ElectionGovernor.sol";

```

[4](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberElectionGovernor.sol#L4), [5](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberElectionGovernor.sol#L5), [6](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberElectionGovernor.sol#L6), [7](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberElectionGovernor.sol#L7), [8](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberElectionGovernor.sol#L8), [9](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberElectionGovernor.sol#L9), [10](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberElectionGovernor.sol#L10), [11](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberElectionGovernor.sol#L11)

```solidity
File: governance/src/security-council-mgmt/governors/SecurityCouncilMemberRemovalGovernor.sol

4: import

6: import

8: import "@openzeppelin/contracts-upgradeable/governance/extensions/GovernorSettingsUpgradeable.sol";

9: import "@openzeppelin/contracts-upgradeable/access/OwnableUpgradeable.sol";

10: import "./../interfaces/ISecurityCouncilManager.sol";

11: import "../Common.sol";

12: import "./modules/ArbitrumGovernorVotesQuorumFractionUpgradeable.sol";

13: import "./modules/ArbitrumGovernorProposalExpirationUpgradeable.sol";

```

[4](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberRemovalGovernor.sol#L4), [6](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberRemovalGovernor.sol#L6), [8](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberRemovalGovernor.sol#L8), [9](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberRemovalGovernor.sol#L9), [10](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberRemovalGovernor.sol#L10), [11](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberRemovalGovernor.sol#L11), [12](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberRemovalGovernor.sol#L12), [13](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberRemovalGovernor.sol#L13)

```solidity
File: governance/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol

4: import "@openzeppelin/contracts-upgradeable/governance/extensions/GovernorSettingsUpgradeable.sol";

5: import "@openzeppelin/contracts-upgradeable/access/OwnableUpgradeable.sol";

6: import "../interfaces/ISecurityCouncilMemberElectionGovernor.sol";

7: import "../interfaces/ISecurityCouncilNomineeElectionGovernor.sol";

8: import "./modules/SecurityCouncilNomineeElectionGovernorCountingUpgradeable.sol";

9: import "./modules/ArbitrumGovernorVotesQuorumFractionUpgradeable.sol";

10: import "./modules/SecurityCouncilNomineeElectionGovernorTiming.sol";

11: import "./modules/ElectionGovernor.sol";

12: import "../SecurityCouncilMgmtUtils.sol";

```

[4](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol#L4), [5](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol#L5), [6](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol#L6), [7](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol#L7), [8](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol#L8), [9](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol#L9), [10](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol#L10), [11](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol#L11), [12](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol#L12)

```solidity
File: governance/src/security-council-mgmt/governors/modules/ArbitrumGovernorVotesQuorumFractionUpgradeable.sol

4: import

```

[4](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/ArbitrumGovernorVotesQuorumFractionUpgradeable.sol#L4)

```solidity
File: governance/src/security-council-mgmt/governors/modules/ElectionGovernor.sol

5: import "@openzeppelin/contracts-upgradeable/utils/StringsUpgradeable.sol";

6: import "../../Common.sol";

```

[5](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/ElectionGovernor.sol#L5), [6](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/ElectionGovernor.sol#L6)

```solidity
File: governance/src/security-council-mgmt/governors/modules/SecurityCouncilMemberElectionGovernorCountingUpgradeable.sol

4: import "@openzeppelin/contracts-upgradeable/governance/GovernorUpgradeable.sol";

6: import "solady/utils/LibSort.sol";

```

[4](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilMemberElectionGovernorCountingUpgradeable.sol#L4), [6](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilMemberElectionGovernorCountingUpgradeable.sol#L6)

```solidity
File: governance/src/security-council-mgmt/governors/modules/SecurityCouncilNomineeElectionGovernorCountingUpgradeable.sol

4: import "@openzeppelin/contracts-upgradeable/governance/GovernorUpgradeable.sol";

```

[4](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilNomineeElectionGovernorCountingUpgradeable.sol#L4)

```solidity
File: governance/src/security-council-mgmt/governors/modules/SecurityCouncilNomineeElectionGovernorTiming.sol

4: import "../../interfaces/ISecurityCouncilManager.sol";

6: import "@openzeppelin/contracts-upgradeable/governance/GovernorUpgradeable.sol";

7: import "solady/utils/DateTimeLib.sol";

8: import "../../Common.sol";

```

[4](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilNomineeElectionGovernorTiming.sol#L4), [6](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilNomineeElectionGovernorTiming.sol#L6), [7](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilNomineeElectionGovernorTiming.sol#L7), [8](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilNomineeElectionGovernorTiming.sol#L8)

</details>


## Gas Optimizations

### <a name="G-01"></a>[G-01] `abi.encode()` is less efficient than `abi.encodepacked()`
See for more information: [refrence](https://github.com/ConnorBlockchain/Solidity-Encode-Gas-Comparison)

*Instances (4)*:

```solidity
File: governance/src/UpgradeExecRouteBuilder.sol

151:                 schedData[i] = abi.encode(

```

[151](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/UpgradeExecRouteBuilder.sol#L151)

```solidity
File: governance/src/gov-action-contracts/execution-record/ActionExecutionRecord.sol

38:         return uint256(keccak256(abi.encode(actionContractId, key)));

```

[38](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/execution-record/ActionExecutionRecord.sol#L38)

```solidity
File: governance/src/gov-action-contracts/execution-record/KeyValueStore.sol

27:         return uint256(keccak256(abi.encode(owner, key)));

```

[27](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/execution-record/KeyValueStore.sol#L27)

```solidity
File: governance/src/security-council-mgmt/governors/modules/ElectionGovernor.sol

23:         electionData[0] = abi.encode(electionIndex);

```

[23](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/ElectionGovernor.sol#L23)

### <a name="G-02"></a>[G-02] Use assembly to check for `address(0)`
*Saves 6 gas per instance*

*Instances (5)*:

```solidity
File: governance/src/UpgradeExecRouteBuilder.sol

72:         if (_l1ArbitrumTimelock == address(0)) {

78:             if (chainAndUpExecLocation.location.upgradeExecutor == address(0)) {

94:         return upExecLocations[_chainId].upgradeExecutor != address(0);

131:             if (upExecLocation.upgradeExecutor == address(0)) {

143:             if (upExecLocation.inbox == address(0)) {

```

[72](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/UpgradeExecRouteBuilder.sol#L72), [78](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/UpgradeExecRouteBuilder.sol#L78), [94](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/UpgradeExecRouteBuilder.sol#L94), [131](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/UpgradeExecRouteBuilder.sol#L131), [143](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/UpgradeExecRouteBuilder.sol#L143)

### <a name="G-03"></a>[G-03] Using `bool`s for storage incurs overhead
Booleans are more expensive than `uint256` or any type that takes up a full word because each write operation emits an extra SLOAD to first read the slot's contents, replace the bits taken up by the boolean, and then write back. This is the compiler's defense against contract upgrades and pointer aliasing, and it cannot be disabled.

*Instances (4)*:

```solidity
File: governance/src/security-council-mgmt/SecurityCouncilMgmtUtils.sol

17:         mapping(address => bool) storage excludeList

```

[17](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilMgmtUtils.sol#L17)

```solidity
File: governance/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol

55:         mapping(address => bool) isContender;

56:         mapping(address => bool) isExcluded;

```

[55](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol#L55), [56](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol#L56)

```solidity
File: governance/src/security-council-mgmt/governors/modules/SecurityCouncilNomineeElectionGovernorCountingUpgradeable.sol

22:         mapping(address => bool) isNominee;

```

[22](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilNomineeElectionGovernorCountingUpgradeable.sol#L22)


### <a name="G-04"></a>[G-04] Use `calldata` instead of `memory` for function arguments that do not get mutated
Mark data types as `calldata` instead of `memory` where possible. This makes it so that the data is not automatically loaded into memory. If the data passed into the function does not need to be changed (like updating values in an array), it can be passed in as `calldata`. The one exception to this is if the argument must later be passed into another function that takes an argument that specifies `memory` storage.

*Instances (36)*:
<details>
<summary>see instances</summary>


```solidity
File: governance/src/UpgradeExecRouteBuilder.sol

68:         ChainAndUpExecLocation[] memory _upgradeExecutors,

106:         uint256[] memory chainIds,

107:         address[] memory actionAddresses,

108:         uint256[] memory actionValues,

109:         bytes[] memory actionDatas,

187:         uint256[] memory chainIds,

188:         address[] memory actionAddresses,

```

[68](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/UpgradeExecRouteBuilder.sol#L68), [106](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/UpgradeExecRouteBuilder.sol#L106), [107](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/UpgradeExecRouteBuilder.sol#L107), [108](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/UpgradeExecRouteBuilder.sol#L108), [109](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/UpgradeExecRouteBuilder.sol#L109), [187](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/UpgradeExecRouteBuilder.sol#L187), [188](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/UpgradeExecRouteBuilder.sol#L188)

```solidity
File: governance/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/SecurityCouncilMgmtUpgradeLib.sol

52:     function areAddressArraysEqual(address[] memory array1, address[] memory array2)

52:     function areAddressArraysEqual(address[] memory array1, address[] memory array2)

```

[52](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/SecurityCouncilMgmtUpgradeLib.sol#L52), [52](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/SecurityCouncilMgmtUpgradeLib.sol#L52)

```solidity
File: governance/src/gov-action-contracts/execution-record/ActionExecutionRecord.sol

18:     constructor(KeyValueStore _store, string memory _uniqueActionName) {

```

[18](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/execution-record/ActionExecutionRecord.sol#L18)

```solidity
File: governance/src/security-council-mgmt/SecurityCouncilManager.sol

90:         address[] memory _firstCohort,

91:         address[] memory _secondCohort,

92:         SecurityCouncilData[] memory _securityCouncils,

93:         SecurityCouncilManagerRoles memory _roles,

124:     function replaceCohort(address[] memory _newCohort, Cohort _cohort)

271:     function addSecurityCouncil(SecurityCouncilData memory _securityCouncilData)

279:     function removeSecurityCouncil(SecurityCouncilData memory _securityCouncilData)

370:     function generateSalt(address[] memory _members, uint256 nonce)

```

[90](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L90), [91](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L91), [92](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L92), [93](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L93), [124](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L124), [271](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L271), [279](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L279), [370](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L370)

```solidity
File: governance/src/security-council-mgmt/SecurityCouncilMemberSyncAction.sol

31:     function perform(address _securityCouncil, address[] memory _updatedMembers, uint256 _nonce)

```

[31](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilMemberSyncAction.sol#L31)

```solidity
File: governance/src/security-council-mgmt/factories/L2SecurityCouncilMgmtFactory.sol

81:     function deploy(DeployParams memory dp, ContractImplementations memory impls)

81:     function deploy(DeployParams memory dp, ContractImplementations memory impls)

```

[81](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/factories/L2SecurityCouncilMgmtFactory.sol#L81), [81](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/factories/L2SecurityCouncilMgmtFactory.sol#L81)

```solidity
File: governance/src/security-council-mgmt/governors/SecurityCouncilMemberElectionGovernor.sol

181:     function propose(address[] memory, uint256[] memory, bytes[] memory, string memory)

181:     function propose(address[] memory, uint256[] memory, bytes[] memory, string memory)

181:     function propose(address[] memory, uint256[] memory, bytes[] memory, string memory)

181:     function propose(address[] memory, uint256[] memory, bytes[] memory, string memory)

```

[181](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberElectionGovernor.sol#L181), [181](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberElectionGovernor.sol#L181), [181](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberElectionGovernor.sol#L181), [181](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberElectionGovernor.sol#L181)

```solidity
File: governance/src/security-council-mgmt/governors/SecurityCouncilMemberRemovalGovernor.sol

107:         address[] memory targets,

108:         uint256[] memory values,

109:         bytes[] memory calldatas,

110:         string memory description

```

[107](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberRemovalGovernor.sol#L107), [108](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberRemovalGovernor.sol#L108), [109](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberRemovalGovernor.sol#L109), [110](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberRemovalGovernor.sol#L110)

```solidity
File: governance/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol

103:     function initialize(InitParams memory params) public initializer {

423:     function propose(address[] memory, uint256[] memory, bytes[] memory, string memory)

423:     function propose(address[] memory, uint256[] memory, bytes[] memory, string memory)

423:     function propose(address[] memory, uint256[] memory, bytes[] memory, string memory)

423:     function propose(address[] memory, uint256[] memory, bytes[] memory, string memory)

```

[103](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol#L103), [423](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol#L423), [423](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol#L423), [423](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol#L423), [423](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol#L423)

```solidity
File: governance/src/security-council-mgmt/governors/modules/SecurityCouncilMemberElectionGovernorCountingUpgradeable.sol

191:     function selectTopNominees(address[] memory nominees, uint240[] memory weights, uint256 k)

191:     function selectTopNominees(address[] memory nominees, uint240[] memory weights, uint256 k)

```

[191](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilMemberElectionGovernorCountingUpgradeable.sol#L191), [191](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilMemberElectionGovernorCountingUpgradeable.sol#L191)

</details>

### <a name="G-05"></a>[G-05] Consider activating `via-ir` for deploying
The IR-based code generator was introduced with an aim to not only allow code generation to be more transparent and auditable but also to enable more powerful optimization passes that span across functions.
You can enable it on the command line using `--via-ir` or with the option `{"viaIR": true}`.
This will take longer to compile, but you can just simple test it before deploying and if you got a better benchmark then you can add`--via-ir` to your deploy command.
More on: [https://docs.soliditylang.org/en/v0.8.17/ir-breaking-changes.html](https://docs.soliditylang.org/en/v0.8.17/ir-breaking-changes.html)

*Instances (1)*:

```solidity
File: Deplyment Files

1: 

```

[1](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L1)

### <a name="G-06"></a>[G-06] Default `bool` values are manually reset
Using `.delete` is better than resetting a Solidity variable to its default value manually because it frees up storage space on the Ethereum blockchain, resulting in gas cost savings.

*Instances (5)*:

```solidity
File: governance/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/SecurityCouncilMgmtUpgradeLib.sol

65:                     found = true;

78:                     found = true;

```

[65](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/SecurityCouncilMgmtUpgradeLib.sol#L65), [78](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/SecurityCouncilMgmtUpgradeLib.sol#L78)

```solidity
File: governance/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol

240:         election.isContender[msg.sender] = true;

279:         election.isExcluded[nominee] = true;

```

[240](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol#L240), [279](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol#L279)

```solidity
File: governance/src/security-council-mgmt/governors/modules/SecurityCouncilNomineeElectionGovernorCountingUpgradeable.sol

123:         _elections[proposalId].isNominee[account] = true;

```

[123](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilNomineeElectionGovernorCountingUpgradeable.sol#L123)

### <a name="G-07"></a>[G-07] Do not calculate constants
Due to how constant variables are implemented (replacements at compile-time), an expression assigned to a constant variable is recomputed each time that the variable is used, which wastes some gas.

*Instances (9)*:
<details>
<summary>see instances</summary>


```solidity
File: governance/src/UpgradeExecRouteBuilder.sol

50:     bytes public constant DEFAULT_GOV_ACTION_CALLDATA =
51:            abi.encodeWithSelector(DefaultGovAction.perform.selector);

54:     bytes32 public constant DEFAULT_PREDECESSOR = bytes32(0);

```

[50-51](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/UpgradeExecRouteBuilder.sol#L50-L51), [54](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/UpgradeExecRouteBuilder.sol#L54)

```solidity
File: governance/src/security-council-mgmt/SecurityCouncilManager.sol

79:     bytes32 public constant COHORT_REPLACER_ROLE = keccak256("COHORT_REPLACER");

80:     bytes32 public constant MEMBER_ADDER_ROLE = keccak256("MEMBER_ADDER");

81:     bytes32 public constant MEMBER_REPLACER_ROLE = keccak256("MEMBER_REPLACER");

82:     bytes32 public constant MEMBER_ROTATOR_ROLE = keccak256("MEMBER_ROTATOR");

83:     bytes32 public constant MEMBER_REMOVER_ROLE = keccak256("MEMBER_REMOVER");

```

[79](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L79), [80](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L80), [81](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L81), [82](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L82), [83](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L83)

```solidity
File: governance/src/security-council-mgmt/SecurityCouncilMemberSyncAction.sol

19:     address public constant SENTINEL_OWNERS = address(0x1);

```

[19](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilMemberSyncAction.sol#L19)

```solidity
File: governance/src/security-council-mgmt/governors/modules/ArbitrumGovernorVotesQuorumFractionUpgradeable.sol

22:     address public constant EXCLUDE_ADDRESS = address(0xA4b86);

```

[22](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/ArbitrumGovernorVotesQuorumFractionUpgradeable.sol#L22)

</details>

### <a name="G-08"></a>[G-08] Empty Blocks Should Be Removed Or Emit Something
The code should be refactored such that they no longer exist, or the block should do something useful, such as emitting an event or reverting. If the contract is meant to be extended, the contract should be abstract and the function signatures be added without any default implementation. If the block is an empty if-statement block to avoid doing subsequent checks in the `else-if`/`else` conditions, the `else-if`/`else` conditions should be nested under the negation of the `if`-statement, because they involve different classes of checks, which may lead to the introduction of errors when the code is later modified(`if(x){}else if(y){...}else{...} => if(!x){if(y){...}else{...}}`)

*Instances (2)*:

```solidity
File: governance/src/security-council-mgmt/SecurityCouncilMemberSyncAction.sol

21:     constructor(KeyValueStore _store)
22:            ActionExecutionRecord(_store, "SecurityCouncilMemberSyncAction")
23:        {}

```

[21-23](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilMemberSyncAction.sol#L21-L23)

```solidity
File: governance/src/security-council-mgmt/governors/modules/SecurityCouncilNomineeElectionGovernorCountingUpgradeable.sol

52:     function __SecurityCouncilNomineeElectionGovernorCounting_init() internal onlyInitializing {}

```

[52](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilNomineeElectionGovernorCountingUpgradeable.sol#L52)

### <a name="G-09"></a>[G-09] Don't initialize `uint`/`int` variables with default value

*Instances (32)*:
<details>
<summary>see instances</summary>


```solidity
File: governance/src/UpgradeExecRouteBuilder.sol

52:     uint256 public constant DEFAULT_VALUE = 0;

76:         for (uint256 i = 0; i < _upgradeExecutors.length; i++) {

129:         for (uint256 i = 0; i < chainIds.length; i++) {

193:         for (uint256 i = 0; i < chainIds.length; i++) {

```

[52](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/UpgradeExecRouteBuilder.sol#L52), [76](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/UpgradeExecRouteBuilder.sol#L76), [129](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/UpgradeExecRouteBuilder.sol#L129), [193](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/UpgradeExecRouteBuilder.sol#L193)

```solidity
File: governance/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/SecurityCouncilMgmtUpgradeLib.sol

61:         for (uint256 i = 0; i < array1.length; i++) {

62:             bool found = false;

63:             for (uint256 j = 0; j < array2.length; j++) {

74:         for (uint256 i = 0; i < array2.length; i++) {

75:             bool found = false;

76:             for (uint256 j = 0; j < array1.length; j++) {

```

[61](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/SecurityCouncilMgmtUpgradeLib.sol#L61), [62](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/SecurityCouncilMgmtUpgradeLib.sol#L62), [63](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/SecurityCouncilMgmtUpgradeLib.sol#L63), [74](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/SecurityCouncilMgmtUpgradeLib.sol#L74), [75](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/SecurityCouncilMgmtUpgradeLib.sol#L75), [76](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/SecurityCouncilMgmtUpgradeLib.sol#L76)

```solidity
File: governance/src/security-council-mgmt/SecurityCouncilManager.sol

106:         for (uint256 i = 0; i < _roles.memberRemovers.length; i++) {

118:         for (uint256 i = 0; i < _securityCouncils.length; i++) {

135:         for (uint256 i = 0; i < _newCohort.length; i++) {

162:         for (uint256 i = 0; i < 2; i++) {

164:             for (uint256 j = 0; j < cohort.length; j++) {

251:         for (uint256 i = 0; i < securityCouncils.length; i++) {

284:         for (uint256 i = 0; i < securityCouncils.length; i++) {

339:         for (uint256 i = 0; i < firstCohort.length; i++) {

342:         for (uint256 i = 0; i < secondCohort.length; i++) {

392:         for (uint256 i = 0; i < securityCouncils.length; i++) {

```

[106](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L106), [118](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L118), [135](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L135), [162](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L162), [164](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L164), [251](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L251), [284](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L284), [339](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L339), [342](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L342), [392](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L392)

```solidity
File: governance/src/security-council-mgmt/SecurityCouncilMemberSyncAction.sol

60:         for (uint256 i = 0; i < _updatedMembers.length; i++) {

67:         for (uint256 i = 0; i < previousOwners.length; i++) {

105:         for (uint256 i = 0; i < owners.length; i++) {

```

[60](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilMemberSyncAction.sol#L60), [67](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilMemberSyncAction.sol#L67), [105](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilMemberSyncAction.sol#L105)

```solidity
File: governance/src/security-council-mgmt/SecurityCouncilMgmtUtils.sol

6:         for (uint256 i = 0; i < arr.length; i++) {

20:         uint256 intermediateLength = 0;

22:         for (uint256 i = 0; i < input.length; i++) {

31:         for (uint256 i = 0; i < intermediateLength; i++) {

```

[6](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilMgmtUtils.sol#L6), [20](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilMgmtUtils.sol#L20), [22](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilMgmtUtils.sol#L22), [31](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilMgmtUtils.sol#L31)

```solidity
File: governance/src/security-council-mgmt/factories/L2SecurityCouncilMgmtFactory.sol

111:         for (uint256 i = 0; i < dp.firstCohort.length; i++) {

117:         for (uint256 i = 0; i < dp.secondCohort.length; i++) {

```

[111](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/factories/L2SecurityCouncilMgmtFactory.sol#L111), [117](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/factories/L2SecurityCouncilMgmtFactory.sol#L117)

```solidity
File: governance/src/security-council-mgmt/governors/modules/SecurityCouncilMemberElectionGovernorCountingUpgradeable.sol

181:         for (uint256 i = 0; i < nominees.length; i++) {

205:         for (uint16 i = 0; i < nominees.length; i++) {

215:         for (uint16 i = 0; i < k; i++) {

```

[181](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilMemberElectionGovernorCountingUpgradeable.sol#L181), [205](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilMemberElectionGovernorCountingUpgradeable.sol#L205), [215](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilMemberElectionGovernorCountingUpgradeable.sol#L215)

</details>

### <a name="G-10"></a>[G-10] Help The Optimizer By Saving A Storage Variable's Reference Instead Of Repeatedly Fetching It
To help the optimizer, declare a storage type variable and use it instead of repeatedly fetching the reference in a map or an array. The effect can be quite significant. As an example, instead of repeatedly calling `someMap[someIndex]`, save its reference like this: `SomeStruct storage someStruct = someMap[someIndex]` and use it.

*Instances (9)*:
<details>
<summary>see instances</summary>


```solidity
File: governance/src/security-council-mgmt/SecurityCouncilManager.sol

252:             SecurityCouncilData storage existantSecurityCouncil = securityCouncils[i];

285:             SecurityCouncilData storage securityCouncilData = securityCouncils[i];

291:                 SecurityCouncilData storage lastSecurityCouncil =

```

[252](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L252), [285](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L285), [291](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L291)

```solidity
File: governance/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol

219:         ElectionInfo storage election = _elections[proposalId];

271:         ElectionInfo storage election = _elections[proposalId];

374:         ElectionInfo storage election = _elections[proposalId];

```

[219](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol#L219), [271](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol#L271), [374](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol#L374)

```solidity
File: governance/src/security-council-mgmt/governors/modules/SecurityCouncilMemberElectionGovernorCountingUpgradeable.sol

120:         ElectionInfo storage election = _elections[proposalId];

180:         ElectionInfo storage election = _elections[proposalId];

```

[120](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilMemberElectionGovernorCountingUpgradeable.sol#L120), [180](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilMemberElectionGovernorCountingUpgradeable.sol#L180)

```solidity
File: governance/src/security-council-mgmt/governors/modules/SecurityCouncilNomineeElectionGovernorCountingUpgradeable.sol

87:         NomineeElectionCountingInfo storage election = _elections[proposalId];

```

[87](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilNomineeElectionGovernorCountingUpgradeable.sol#L87)

</details>


### <a name="G-11"></a>[G-11] `require()` or `revert()` statements that check input arguments should be at the top of the function
Checks that involve constants should come before checks that involve state variables, function calls, and calculations. By doing these checks first, the function is able to revert before wasting a Gcoldsload (2100 gas*) in a function that may ultimately revert in the unhappy case.

*Instances (1)*:

```solidity
File: governance/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/SecurityCouncilMgmtUpgradeLib.sol

39:         require(

```

[39](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/SecurityCouncilMgmtUpgradeLib.sol#L39)

### <a name="G-12"></a>[G-12] Shorten the array rather than copying to a new one
Inline-assembly can be used to shorten the array by changing the length slot, so that the entries don't have to be copied to a new, shorter array.

*Instances (19)*:
<details>
<summary>see instances</summary>


```solidity
File: governance/src/UpgradeExecRouteBuilder.sol

123:         address[] memory schedTargets = new address[](chainIds.length);

124:         uint256[] memory schedValues = new uint256[](chainIds.length);

125:         bytes[] memory schedData = new bytes[](chainIds.length);

191:         uint256[] memory values = new uint256[](chainIds.length);

192:         bytes[] memory actionDatas = new bytes[](chainIds.length);

```

[123](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/UpgradeExecRouteBuilder.sol#L123), [124](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/UpgradeExecRouteBuilder.sol#L124), [125](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/UpgradeExecRouteBuilder.sol#L125), [191](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/UpgradeExecRouteBuilder.sol#L191), [192](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/UpgradeExecRouteBuilder.sol#L192)

```solidity
File: governance/src/security-council-mgmt/SecurityCouncilManager.sol

338:         address[] memory members = new address[](firstCohort.length + secondCohort.length);

388:         address[] memory actionAddresses = new address[](securityCouncils.length);

389:         bytes[] memory actionDatas = new bytes[](securityCouncils.length);

390:         uint256[] memory chainIds = new uint256[](securityCouncils.length);

409:             new uint256[](securityCouncils.length), // all values are always 0

```

[338](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L338), [388](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L388), [389](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L389), [390](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L390), [409](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L409)

```solidity
File: governance/src/security-council-mgmt/SecurityCouncilMgmtUtils.sol

19:         address[] memory intermediate = new address[](input.length);

30:         address[] memory output = new address[](intermediateLength);

```

[19](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilMgmtUtils.sol#L19), [30](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilMgmtUtils.sol#L30)

```solidity
File: governance/src/security-council-mgmt/factories/L2SecurityCouncilMgmtFactory.sol

146:         address[] memory memberRemovers = new address[](2);

```

[146](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/factories/L2SecurityCouncilMgmtFactory.sol#L146)

```solidity
File: governance/src/security-council-mgmt/governors/modules/ElectionGovernor.sol

22:         bytes[] memory electionData = new bytes[](1);

25:             new address[](1),

26:             new uint256[](1),

```

[22](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/ElectionGovernor.sol#L22), [25](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/ElectionGovernor.sol#L25), [26](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/ElectionGovernor.sol#L26)

```solidity
File: governance/src/security-council-mgmt/governors/modules/SecurityCouncilMemberElectionGovernorCountingUpgradeable.sol

179:         uint240[] memory weights = new uint240[](nominees.length);

203:         uint256[] memory topNomineesPacked = new uint256[](k);

214:         address[] memory topNomineesAddresses = new address[](k);

```

[179](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilMemberElectionGovernorCountingUpgradeable.sol#L179), [203](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilMemberElectionGovernorCountingUpgradeable.sol#L203), [214](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilMemberElectionGovernorCountingUpgradeable.sol#L214)

</details>

### <a name="G-13"></a>[G-13] Usage of `uint`s/`int`s smaller than 32 bytes (256 bits) incurs overhead
When using elements that are smaller than 32 bytes, your contract’s gas usage may be higher. This is because the EVM operates on 32 bytes at a time. Therefore, if the element is smaller than that, the EVM must use more operations in order to reduce the size of the element from 32 bytes to the desired size.
 [soliditylang docs](https://docs.soliditylang.org/en/v0.8.11/internals/layout_in_storage.html)Each operation involving a `uint8` costs an extra [22-28 gas](https://gist.github.com/IllIllI000/9388d20c70f9a4632eb3ca7836f54977)(depending on whether the other operand is also a variable of type `uint8`) as compared to ones involving `uint256`, due to the compiler having to clear the higher bits of the memory word before operating on the `uint8`, as well as the associated stack operations of doing so. Use a larger size then downcast where needed

*Instances (22)*:
<details>
<summary>see instances</summary>


```solidity
File: governance/src/security-council-mgmt/factories/L2SecurityCouncilMgmtFactory.sol

34:     uint64 removalGovMinPeriodAfterQuorum;

```

[34](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/factories/L2SecurityCouncilMgmtFactory.sol#L34)

```solidity
File: governance/src/security-council-mgmt/governors/SecurityCouncilMemberElectionGovernor.sol

191:     function castVote(uint256, uint8) public virtual override returns (uint256) {

196:     function castVoteWithReason(uint256, uint8, string calldata)

206:     function castVoteBySig(uint256, uint8, uint8, bytes32, bytes32)

206:     function castVoteBySig(uint256, uint8, uint8, bytes32, bytes32)

```

[191](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberElectionGovernor.sol#L191), [196](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberElectionGovernor.sol#L196), [206](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberElectionGovernor.sol#L206), [206](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberElectionGovernor.sol#L206)

```solidity
File: governance/src/security-council-mgmt/governors/SecurityCouncilMemberRemovalGovernor.sol

67:         uint64 _minPeriodAfterQuorum,

166:         uint8 support,

226:         uint8 support,

```

[67](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberRemovalGovernor.sol#L67), [166](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberRemovalGovernor.sol#L166), [226](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberRemovalGovernor.sol#L226)

```solidity
File: governance/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol

433:     function castVote(uint256, uint8) public virtual override returns (uint256) {

438:     function castVoteWithReason(uint256, uint8, string calldata)

448:     function castVoteBySig(uint256, uint8, uint8, bytes32, bytes32)

448:     function castVoteBySig(uint256, uint8, uint8, bytes32, bytes32)

```

[433](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol#L433), [438](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol#L438), [448](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol#L448), [448](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol#L448)

```solidity
File: governance/src/security-council-mgmt/governors/modules/SecurityCouncilMemberElectionGovernorCountingUpgradeable.sol

65:     error InvalidSupport(uint8 support);

98:         uint8 support,

115:         uint240 weight = votesToWeight(proposalId, block.number, votes);

126:         uint240 prevWeightReceived = election.weightReceived[nominee];

205:         for (uint16 i = 0; i < nominees.length; i++) {

215:         for (uint16 i = 0; i < k; i++) {

228:         returns (uint240)

259:     function _downCast(uint256 x) internal pure returns (uint240) {

```

[65](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilMemberElectionGovernorCountingUpgradeable.sol#L65), [98](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilMemberElectionGovernorCountingUpgradeable.sol#L98), [115](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilMemberElectionGovernorCountingUpgradeable.sol#L115), [126](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilMemberElectionGovernorCountingUpgradeable.sol#L126), [205](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilMemberElectionGovernorCountingUpgradeable.sol#L205), [215](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilMemberElectionGovernorCountingUpgradeable.sol#L215), [228](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilMemberElectionGovernorCountingUpgradeable.sol#L228), [259](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilMemberElectionGovernorCountingUpgradeable.sol#L259)

```solidity
File: governance/src/security-council-mgmt/governors/modules/SecurityCouncilNomineeElectionGovernorCountingUpgradeable.sol

50:     error InvalidSupport(uint8 support);

65:         uint8 support,

```

[50](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilNomineeElectionGovernorCountingUpgradeable.sol#L50), [65](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilNomineeElectionGovernorCountingUpgradeable.sol#L65)

</details>

### <a name="G-14"></a>[G-14] Incrementing with a smaller type than `uint256` incurs overhead

*Instances (2)*:

```solidity
File: governance/src/security-council-mgmt/governors/modules/SecurityCouncilMemberElectionGovernorCountingUpgradeable.sol

205:         for (uint16 i = 0; i < nominees.length; i++) {

215:         for (uint16 i = 0; i < k; i++) {

```

[205](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilMemberElectionGovernorCountingUpgradeable.sol#L205), [215](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilMemberElectionGovernorCountingUpgradeable.sol#L215)

### <a name="G-15"></a>[G-15] State variables which are not modified within functions should be set as `constant` or `immutable` for values set at deployment
Cache such variables and perform operations on them, if operations include modifications to the state variable(s) then remember to equate the state variable to it's cached counterpart at the end

*Instances (10)*:
<details>
<summary>see instances</summary>


```solidity
File: governance/src/UpgradeExecRouteBuilder.sol

62:     mapping(uint256 => UpExecLocation) public upExecLocations;

```

[62](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/UpgradeExecRouteBuilder.sol#L62)

```solidity
File: governance/src/security-council-mgmt/SecurityCouncilManager.sol

70:     uint256 public updateNonce;

```

[70](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L70)

```solidity
File: governance/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol

71:     uint256 public electionCount;

74:     mapping(uint256 => ElectionInfo) internal _elections;

```

[71](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol#L71), [74](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol#L74)

```solidity
File: governance/src/security-council-mgmt/governors/modules/ArbitrumGovernorVotesQuorumFractionUpgradeable.sol

54:     uint256[50] private __gap;

```

[54](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/ArbitrumGovernorVotesQuorumFractionUpgradeable.sol#L54)

```solidity
File: governance/src/security-council-mgmt/governors/modules/ElectionGovernor.sol

59:     uint256[50] private __gap;

```

[59](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/ElectionGovernor.sol#L59)

```solidity
File: governance/src/security-council-mgmt/governors/modules/SecurityCouncilMemberElectionGovernorCountingUpgradeable.sol

31:     mapping(uint256 => ElectionInfo) private _elections;

299:     uint256[48] private __gap;

```

[31](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilMemberElectionGovernorCountingUpgradeable.sol#L31), [299](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilMemberElectionGovernorCountingUpgradeable.sol#L299)

```solidity
File: governance/src/security-council-mgmt/governors/modules/SecurityCouncilNomineeElectionGovernorCountingUpgradeable.sol

184:     uint256[49] private __gap;

```

[184](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilNomineeElectionGovernorCountingUpgradeable.sol#L184)

```solidity
File: governance/src/security-council-mgmt/governors/modules/SecurityCouncilNomineeElectionGovernorTiming.sol

101:     uint256[45] private __gap;

```

[101](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilNomineeElectionGovernorTiming.sol#L101)

</details>

### <a name="G-16"></a>[G-16] State variables used within a function more than once should be cached to save gas
Set state variables listed below as constant or immutable for values set at deployment. Ensure it is safe to do so

*Instances (69)*:
<details>
<summary>see instances</summary>


```solidity
File: governance/src/UpgradeExecRouteBuilder.sol

/// @audit used befor on lines 4, 22
22:         l1TimelockMinDelay = _l1TimelockMinDelay;

```

[22](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/UpgradeExecRouteBuilder.sol#L22)

```solidity
File: governance/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/GovernanceChainSCMgmtActivationAction.sol

/// @audit used befor on lines 2, 11
11:         newEmergencySecurityCouncil = _newEmergencySecurityCouncil;

/// @audit used befor on lines 3, 12
12:         newNonEmergencySecurityCouncil = _newNonEmergencySecurityCouncil;

/// @audit used befor on lines 4, 14
14:         prevEmergencySecurityCouncil = _prevEmergencySecurityCouncil;

/// @audit used befor on lines 5, 15
15:         prevNonEmergencySecurityCouncil = _prevNonEmergencySecurityCouncil;

/// @audit used befor on lines 6, 17
17:         emergencySecurityCouncilThreshold = _emergencySecurityCouncilThreshold;

/// @audit used befor on lines 7, 18
18:         nonEmergencySecurityCouncilThreshold = _nonEmergencySecurityCouncilThreshold;

/// @audit used befor on lines 8, 20
20:         securityCouncilManager = _securityCouncilManager;

/// @audit used befor on line 2
20:             ICoreTimelock(address(l2AddressRegistry.coreGovTimelock()));

/// @audit used befor on lines 9, 21
21:         l2AddressRegistry = _l2AddressRegistry;

/// @audit used befor on line 7
69:             upgradeExecutor.hasRole(EXECUTOR_ROLE, address(newEmergencySecurityCouncil)),

/// @audit used befor on lines 14, 27, 39
79:                 TIMELOCK_PROPOSAL_ROLE, address(prevNonEmergencySecurityCouncil)

/// @audit used befor on lines 15, 33, 42
85:                 TIMELOCK_PROPOSAL_ROLE, address(newNonEmergencySecurityCouncil)

/// @audit used befor on lines 46, 51, 52, 54, 91
92:             "GovernanceChainSCMgmtActivationAction: securityCouncilManager doesn't have proposal role"

/// @audit used befor on lines 6, 59, 64, 73
96:                 TIMELOCK_CANCELLER_ROLE, address(prevEmergencySecurityCouncil)

```

[11](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/GovernanceChainSCMgmtActivationAction.sol#L11), [12](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/GovernanceChainSCMgmtActivationAction.sol#L12), [14](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/GovernanceChainSCMgmtActivationAction.sol#L14), [15](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/GovernanceChainSCMgmtActivationAction.sol#L15), [17](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/GovernanceChainSCMgmtActivationAction.sol#L17), [18](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/GovernanceChainSCMgmtActivationAction.sol#L18), [20](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/GovernanceChainSCMgmtActivationAction.sol#L20), [20](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/GovernanceChainSCMgmtActivationAction.sol#L20), [21](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/GovernanceChainSCMgmtActivationAction.sol#L21), [69](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/GovernanceChainSCMgmtActivationAction.sol#L69), [79](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/GovernanceChainSCMgmtActivationAction.sol#L79), [85](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/GovernanceChainSCMgmtActivationAction.sol#L85), [92](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/GovernanceChainSCMgmtActivationAction.sol#L92), [96](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/GovernanceChainSCMgmtActivationAction.sol#L96)

```solidity
File: governance/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/L1SCMgmtActivationAction.sol

/// @audit used befor on lines 2, 8
8:         newEmergencySecurityCouncil = _newEmergencySecurityCouncil;

/// @audit used befor on lines 3, 9
9:         prevEmergencySecurityCouncil = _prevEmergencySecurityCouncil;

/// @audit used befor on lines 4, 10
10:         emergencySecurityCouncilThreshold = _emergencySecurityCouncilThreshold;

/// @audit used befor on lines 5, 11
11:         l1UpgradeExecutor = _l1UpgradeExecutor;

/// @audit used befor on lines 6, 12
12:         l1Timelock = _l1Timelock;

/// @audit used befor on lines 7, 17, 18, 22, 26
27:             "GovernanceChainSCMgmtActivationAction: l1UpgradeExecutor canceller role not set"

/// @audit used befor on lines 11, 13, 17, 21, 22, 26
30:             !l1Timelock.hasRole(TIMELOCK_CANCELLER_ROLE, address(prevEmergencySecurityCouncil)),

/// @audit used befor on lines 4, 13, 21, 30
31:             "GovernanceChainSCMgmtActivationAction: prevEmergencySecurityCouncil canceller role not revoked"

```

[8](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/L1SCMgmtActivationAction.sol#L8), [9](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/L1SCMgmtActivationAction.sol#L9), [10](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/L1SCMgmtActivationAction.sol#L10), [11](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/L1SCMgmtActivationAction.sol#L11), [12](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/L1SCMgmtActivationAction.sol#L12), [27](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/L1SCMgmtActivationAction.sol#L27), [30](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/L1SCMgmtActivationAction.sol#L30), [31](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/L1SCMgmtActivationAction.sol#L31)

```solidity
File: governance/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/NonGovernanceChainSCMgmtActivationAction.sol

/// @audit used befor on lines 2, 7
7:         newEmergencySecurityCouncil = _newEmergencySecurityCouncil;

/// @audit used befor on lines 3, 8
8:         prevEmergencySecurityCouncil = _prevEmergencySecurityCouncil;

/// @audit used befor on lines 4, 9
9:         emergencySecurityCouncilThreshold = _emergencySecurityCouncilThreshold;

/// @audit used befor on lines 5, 10
10:         upgradeExecutor = _upgradeExecutor;

/// @audit used befor on line 5
13:             upgradeExecutor.hasRole(EXECUTOR_ROLE, address(newEmergencySecurityCouncil)),

/// @audit used befor on line 4
17:             !upgradeExecutor.hasRole(EXECUTOR_ROLE, address(prevEmergencySecurityCouncil)),

/// @audit used befor on lines 7, 7, 11, 13
17:             !upgradeExecutor.hasRole(EXECUTOR_ROLE, address(prevEmergencySecurityCouncil)),

```

[7](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/NonGovernanceChainSCMgmtActivationAction.sol#L7), [8](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/NonGovernanceChainSCMgmtActivationAction.sol#L8), [9](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/NonGovernanceChainSCMgmtActivationAction.sol#L9), [10](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/NonGovernanceChainSCMgmtActivationAction.sol#L10), [13](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/NonGovernanceChainSCMgmtActivationAction.sol#L13), [17](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/NonGovernanceChainSCMgmtActivationAction.sol#L17), [17](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/NonGovernanceChainSCMgmtActivationAction.sol#L17)

```solidity
File: governance/src/gov-action-contracts/execution-record/ActionExecutionRecord.sol

/// @audit used befor on lines 1, 2
2:         store = _store;

```

[2](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/execution-record/ActionExecutionRecord.sol#L2)

```solidity
File: governance/src/security-council-mgmt/SecurityCouncilManager.sol

/// @audit used befor on line 1
2:         return securityCouncils.length;

/// @audit used befor on line 1
5:         _setUpgradeExecRouteBuilder(_router);

/// @audit used befor on lines 5, 6
6:             revert InvalidNewCohortLength({cohort: _newCohort, cohortSize: cohortSize});

/// @audit used befor on lines 2, 3, 4
7:             members[firstCohort.length + i] = secondCohort[i];

/// @audit used befor on lines 2, 6
7:             members[firstCohort.length + i] = secondCohort[i];

/// @audit used befor on line 5
9:         if (firstCohortIncludes(_newMember)) {

/// @audit used befor on lines 1, 2, 2, 4, 5, 8, 8
9:         emit UpgradeExecRouteBuilderSet(routerAddress);

/// @audit used befor on line 5
12:         if (secondCohortIncludes(_newMember)) {

/// @audit used befor on lines 3, 9, 10, 13
13:         secondCohort = _secondCohort;

/// @audit used befor on lines 2, 9, 10, 12, 12
14:         cohortSize = _firstCohort.length;

/// @audit used befor on lines 6, 7, 14, 14, 16, 17
21:                     securityCouncils.length

/// @audit used befor on lines 5, 7
21:             salt: this.generateSalt(newMembers, updateNonce),

/// @audit used befor on line 9
22:             delay: ArbitrumTimelock(l2CoreGovTimelock).getMinDelay()

/// @audit used befor on lines 6, 24, 25, 27
27:         l2CoreGovTimelock = _l2CoreGovTimelock;

/// @audit used befor on line 7
29:         _setUpgradeExecRouteBuilder(_router);

/// @audit used befor on lines 4, 30
31:             _addSecurityCouncil(_securityCouncils[i]);

/// @audit used befor on lines 10, 11, 12, 14, 15
31:             new uint256[](securityCouncils.length), // all values are always 0

/// @audit used befor on lines 2, 3, 21, 22, 32
36:             securityCouncils.length

```

[2](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L2), [5](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L5), [6](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L6), [7](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L7), [7](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L7), [9](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L9), [9](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L9), [12](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L12), [13](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L13), [14](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L14), [21](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L21), [21](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L21), [22](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L22), [27](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L27), [29](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L29), [31](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L31), [31](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L31), [36](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L36)

```solidity
File: governance/src/security-council-mgmt/governors/SecurityCouncilMemberElectionGovernor.sol

/// @audit used befor on lines 2, 21, 22, 24
24:         nomineeElectionGovernor = _nomineeElectionGovernor;

/// @audit used befor on lines 3, 25, 26, 28
28:         securityCouncilManager = _securityCouncilManager;

```

[24](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberElectionGovernor.sol#L24), [28](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberElectionGovernor.sol#L28)

```solidity
File: governance/src/security-council-mgmt/governors/SecurityCouncilMemberRemovalGovernor.sol

/// @audit used befor on line 1
2:         _setVoteSuccessNumerator(_voteSuccessNumerator);

/// @audit used befor on lines 1, 2, 2, 3, 5, 5
6:         emit VoteSuccessNumeratorSet(_voteSuccessNumerator);

/// @audit used befor on lines 3, 21, 22, 25
25:         securityCouncilManager = _securityCouncilManager;

/// @audit used befor on line 2
26:         _setVoteSuccessNumerator(_voteSuccessNumerator);

/// @audit used befor on lines 12, 30
31:                 && !securityCouncilManager.secondCohortIncludes(memberToRemove)

```

[2](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberRemovalGovernor.sol#L2), [6](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberRemovalGovernor.sol#L6), [25](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberRemovalGovernor.sol#L25), [26](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberRemovalGovernor.sol#L26), [31](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberRemovalGovernor.sol#L31)

```solidity
File: governance/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol

/// @audit used befor on line 3
3:         return electionCount == 0 ? Cohort.FIRST : electionIndexToCohort(electionCount - 1);

/// @audit used befor on line 3
3:         return (electionCount < 2) ? Cohort.SECOND : electionIndexToCohort(electionCount - 2);

/// @audit used befor on lines 1, 2, 3, 3
4:         emit NomineeVetterChanged(oldNomineeVetter, _nomineeVetter);

/// @audit used befor on line 2
11:         ) = getProposeArgs(electionCount - 1);

/// @audit used befor on line 12
12:         nomineeVetter = params.nomineeVetter;

/// @audit used befor on lines 13, 14, 16
16:         securityCouncilManager = params.securityCouncilManager;

/// @audit used befor on lines 17, 18, 20
20:         securityCouncilMemberElectionGovernor = params.securityCouncilMemberElectionGovernor;

/// @audit used befor on lines 6, 16
20:         electionCount++;

/// @audit used befor on line 12
23:         if (securityCouncilManager.cohortIncludes(otherCohort(), account)) {

```

[3](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol#L3), [3](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol#L3), [4](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol#L4), [11](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol#L11), [12](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol#L12), [16](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol#L16), [20](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol#L20), [20](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol#L20), [23](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol#L23)

```solidity
File: governance/src/security-council-mgmt/governors/modules/SecurityCouncilNomineeElectionGovernorCountingUpgradeable.sol

/// @audit used befor on line 2
3:         _elections[proposalId].isNominee[account] = true;

```

[3](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilNomineeElectionGovernorCountingUpgradeable.sol#L3)

```solidity
File: governance/src/security-council-mgmt/governors/modules/SecurityCouncilNomineeElectionGovernorTiming.sol

/// @audit used befor on lines 3, 6, 15
16:             hour: firstNominationStartDate.hour,

/// @audit used befor on lines 2, 6, 7, 8, 9, 16, 17, 18, 19, 25, 26, 27, 28, 37
37:         firstNominationStartDate = _firstNominationStartDate;

/// @audit used befor on lines 3, 38
38:         nomineeVettingDuration = _nomineeVettingDuration;

```

[16](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilNomineeElectionGovernorTiming.sol#L16), [37](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilNomineeElectionGovernorTiming.sol#L37), [38](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilNomineeElectionGovernorTiming.sol#L38)

</details>

### <a name="G-17"></a>[G-17] Increments can be `unchecked` in for-loops

*Instances (28)*:
<details>
<summary>see instances</summary>


```solidity
File: governance/src/UpgradeExecRouteBuilder.sol

76:         for (uint256 i = 0; i < _upgradeExecutors.length; i++) {

129:         for (uint256 i = 0; i < chainIds.length; i++) {

193:         for (uint256 i = 0; i < chainIds.length; i++) {

```

[76](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/UpgradeExecRouteBuilder.sol#L76), [129](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/UpgradeExecRouteBuilder.sol#L129), [193](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/UpgradeExecRouteBuilder.sol#L193)

```solidity
File: governance/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/SecurityCouncilMgmtUpgradeLib.sol

61:         for (uint256 i = 0; i < array1.length; i++) {

63:             for (uint256 j = 0; j < array2.length; j++) {

74:         for (uint256 i = 0; i < array2.length; i++) {

76:             for (uint256 j = 0; j < array1.length; j++) {

```

[61](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/SecurityCouncilMgmtUpgradeLib.sol#L61), [63](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/SecurityCouncilMgmtUpgradeLib.sol#L63), [74](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/SecurityCouncilMgmtUpgradeLib.sol#L74), [76](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/SecurityCouncilMgmtUpgradeLib.sol#L76)

```solidity
File: governance/src/security-council-mgmt/SecurityCouncilManager.sol

106:         for (uint256 i = 0; i < _roles.memberRemovers.length; i++) {

118:         for (uint256 i = 0; i < _securityCouncils.length; i++) {

135:         for (uint256 i = 0; i < _newCohort.length; i++) {

162:         for (uint256 i = 0; i < 2; i++) {

164:             for (uint256 j = 0; j < cohort.length; j++) {

251:         for (uint256 i = 0; i < securityCouncils.length; i++) {

284:         for (uint256 i = 0; i < securityCouncils.length; i++) {

339:         for (uint256 i = 0; i < firstCohort.length; i++) {

342:         for (uint256 i = 0; i < secondCohort.length; i++) {

392:         for (uint256 i = 0; i < securityCouncils.length; i++) {

```

[106](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L106), [118](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L118), [135](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L135), [162](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L162), [164](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L164), [251](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L251), [284](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L284), [339](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L339), [342](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L342), [392](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L392)

```solidity
File: governance/src/security-council-mgmt/SecurityCouncilMemberSyncAction.sol

60:         for (uint256 i = 0; i < _updatedMembers.length; i++) {

67:         for (uint256 i = 0; i < previousOwners.length; i++) {

105:         for (uint256 i = 0; i < owners.length; i++) {

```

[60](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilMemberSyncAction.sol#L60), [67](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilMemberSyncAction.sol#L67), [105](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilMemberSyncAction.sol#L105)

```solidity
File: governance/src/security-council-mgmt/SecurityCouncilMgmtUtils.sol

6:         for (uint256 i = 0; i < arr.length; i++) {

22:         for (uint256 i = 0; i < input.length; i++) {

31:         for (uint256 i = 0; i < intermediateLength; i++) {

```

[6](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilMgmtUtils.sol#L6), [22](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilMgmtUtils.sol#L22), [31](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilMgmtUtils.sol#L31)

```solidity
File: governance/src/security-council-mgmt/factories/L2SecurityCouncilMgmtFactory.sol

111:         for (uint256 i = 0; i < dp.firstCohort.length; i++) {

117:         for (uint256 i = 0; i < dp.secondCohort.length; i++) {

```

[111](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/factories/L2SecurityCouncilMgmtFactory.sol#L111), [117](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/factories/L2SecurityCouncilMgmtFactory.sol#L117)

```solidity
File: governance/src/security-council-mgmt/governors/modules/SecurityCouncilMemberElectionGovernorCountingUpgradeable.sol

181:         for (uint256 i = 0; i < nominees.length; i++) {

205:         for (uint16 i = 0; i < nominees.length; i++) {

215:         for (uint16 i = 0; i < k; i++) {

```

[181](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilMemberElectionGovernorCountingUpgradeable.sol#L181), [205](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilMemberElectionGovernorCountingUpgradeable.sol#L205), [215](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilMemberElectionGovernorCountingUpgradeable.sol#L215)

</details>

### <a name="G-18"></a>[G-18] Use `!= 0` instead of `> 0` for unsigned integer comparison
*Saves 6 gas per instance*

*Instances (3)*:

```solidity
File: governance/src/security-council-mgmt/governors/SecurityCouncilMemberRemovalGovernor.sol

183:         if (!(0 < _voteSuccessNumerator && _voteSuccessNumerator <= voteSuccessDenominator)) {

```

[183](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberRemovalGovernor.sol#L183)

```solidity
File: governance/src/security-council-mgmt/governors/modules/SecurityCouncilMemberElectionGovernorCountingUpgradeable.sol

159:         return votesUsed(proposalId, account) > 0;

```

[159](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilMemberElectionGovernorCountingUpgradeable.sol#L159)

```solidity
File: governance/src/security-council-mgmt/governors/modules/SecurityCouncilNomineeElectionGovernorCountingUpgradeable.sol

134:         return _elections[proposalId].votesUsed[account] > 0;

```

[134](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilNomineeElectionGovernorCountingUpgradeable.sol#L134)

### <a name="G-19"></a>[G-19] Unused named return variables without optimizer waste gas
Consider changing the variable to be an unnamed one, since the variable is never assigned, nor is it returned by name. If the optimizer is not turned on, leaving the code as it is will also waste gas for the stack variable.

*Instances (2)*:

```solidity
File: governance/src/security-council-mgmt/SecurityCouncilMemberSyncAction.sol

31:     function perform(address _securityCouncil, address[] memory _updatedMembers, uint256 _nonce)
32:            external
33:            returns (bool res)
34:        {

```

[31-34](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilMemberSyncAction.sol#L31-L34)

```solidity
File: governance/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol

161:     function createElection() external returns (uint256 proposalId) {

```

[161](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol#L161)

### <a name="G-20"></a>[G-20] Use `assembly` to write address storage values

*Instances (5)*:

```solidity
File: governance/src/UpgradeExecRouteBuilder.sol

67:     constructor(
68:            ChainAndUpExecLocation[] memory _upgradeExecutors,
69:            address _l1ArbitrumTimelock,
70:            uint256 _l1TimelockMinDelay
71:        ) {
72:            if (_l1ArbitrumTimelock == address(0)) {
73:                revert ZeroAddress();
74:            }
75:    
76:            for (uint256 i = 0; i < _upgradeExecutors.length; i++) {
77:                ChainAndUpExecLocation memory chainAndUpExecLocation = _upgradeExecutors[i];
78:                if (chainAndUpExecLocation.location.upgradeExecutor == address(0)) {
79:                    revert ZeroAddress();
80:                }
81:                if (upExecLocationExists(chainAndUpExecLocation.chainId)) {
82:                    revert UpgradeExecAlreadyExists(chainAndUpExecLocation.chainId);
83:                }
84:                upExecLocations[chainAndUpExecLocation.chainId] = chainAndUpExecLocation.location;
85:            }
86:    
87:            l1TimelockAddr = _l1ArbitrumTimelock;
88:            l1TimelockMinDelay = _l1TimelockMinDelay;
89:        }

105:     function createActionRouteData(
106:             uint256[] memory chainIds,
107:             address[] memory actionAddresses,
108:             uint256[] memory actionValues,
109:             bytes[] memory actionDatas,
110:             bytes32 predecessor,
111:             bytes32 timelockSalt
112:         ) public view returns (address, bytes memory) {
113:             if (chainIds.length != actionAddresses.length) {
114:                 revert ParamLengthMismatch(chainIds.length, actionAddresses.length);
115:             }
116:             if (chainIds.length != actionValues.length) {
117:                 revert ParamLengthMismatch(chainIds.length, actionValues.length);
118:             }
119:             if (chainIds.length != actionDatas.length) {
120:                 revert ParamLengthMismatch(chainIds.length, actionDatas.length);
121:             }
122:     
123:             address[] memory schedTargets = new address[](chainIds.length);
124:             uint256[] memory schedValues = new uint256[](chainIds.length);
125:             bytes[] memory schedData = new bytes[](chainIds.length);
126:     
127:             // for each chain create calldata that targets the upgrade executor
128:             // from the l1 timelock
129:             for (uint256 i = 0; i < chainIds.length; i++) {
130:                 UpExecLocation memory upExecLocation = upExecLocations[chainIds[i]];
131:                 if (upExecLocation.upgradeExecutor == address(0)) {
132:                     revert UpgadeExecDoesntExist(chainIds[i]);
133:                 }
134:                 if (actionDatas[i].length == 0) {
135:                     revert EmptyActionBytesData(actionDatas);
136:                 }
137:     
138:                 bytes memory executorData = abi.encodeWithSelector(
139:                     UpgradeExecutor.execute.selector, actionAddresses[i], actionDatas[i]
140:                 );
141:     
142:                 // for L1, inbox is set to address(0):
143:                 if (upExecLocation.inbox == address(0)) {
144:                     schedTargets[i] = upExecLocation.upgradeExecutor;
145:                     schedValues[i] = actionValues[i];
146:                     schedData[i] = executorData;
147:                 } else {
148:                     // For L2 actions, magic is top level target, and value and calldata are encoded in payload
149:                     schedTargets[i] = RETRYABLE_TICKET_MAGIC;
150:                     schedValues[i] = 0;
151:                     schedData[i] = abi.encode(
152:                         upExecLocation.inbox,
153:                         upExecLocation.upgradeExecutor,
154:                         actionValues[i],
155:                         0,
156:                         0,
157:                         executorData
158:                     );
159:                 }
160:             }
161:     
162:             // batch those calls to execute from the l1 timelock
163:             bytes memory timelockCallData = abi.encodeWithSelector(
164:                 L1ArbitrumTimelock.scheduleBatch.selector,
165:                 schedTargets,
166:                 schedValues,
167:                 schedData,
168:                 predecessor,
169:                 timelockSalt,
170:                 l1TimelockMinDelay
171:             );
172:     
173:             // create a message to initiate a withdrawal to the L1 timelock
174:             return (
175:                 address(100),
176:                 abi.encodeWithSelector(ArbSys.sendTxToL1.selector, l1TimelockAddr, timelockCallData)
177:             );
178:         }

```

[67-89](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/UpgradeExecRouteBuilder.sol#L67-L89), [105-178](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/UpgradeExecRouteBuilder.sol#L105-L178)

```solidity
File: governance/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/GovernanceChainSCMgmtActivationAction.sol

25:     constructor(
26:            IGnosisSafe _newEmergencySecurityCouncil,
27:            IGnosisSafe _newNonEmergencySecurityCouncil,
28:            IGnosisSafe _prevEmergencySecurityCouncil,
29:            IGnosisSafe _prevNonEmergencySecurityCouncil,
30:            uint256 _emergencySecurityCouncilThreshold,
31:            uint256 _nonEmergencySecurityCouncilThreshold,
32:            address _securityCouncilManager,
33:            IL2AddressRegistry _l2AddressRegistry
34:        ) {
35:            newEmergencySecurityCouncil = _newEmergencySecurityCouncil;
36:            newNonEmergencySecurityCouncil = _newNonEmergencySecurityCouncil;
37:    
38:            prevEmergencySecurityCouncil = _prevEmergencySecurityCouncil;
39:            prevNonEmergencySecurityCouncil = _prevNonEmergencySecurityCouncil;
40:    
41:            emergencySecurityCouncilThreshold = _emergencySecurityCouncilThreshold;
42:            nonEmergencySecurityCouncilThreshold = _nonEmergencySecurityCouncilThreshold;
43:    
44:            securityCouncilManager = _securityCouncilManager;
45:            l2AddressRegistry = _l2AddressRegistry;
46:        }

```

[25-46](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/GovernanceChainSCMgmtActivationAction.sol#L25-L46)

```solidity
File: governance/src/security-council-mgmt/SecurityCouncilMgmtUtils.sol

15:     function filterAddressesWithExcludeList(
16:            address[] memory input,
17:            mapping(address => bool) storage excludeList
18:        ) internal view returns (address[] memory) {
19:            address[] memory intermediate = new address[](input.length);
20:            uint256 intermediateLength = 0;
21:    
22:            for (uint256 i = 0; i < input.length; i++) {
23:                address nominee = input[i];
24:                if (!excludeList[nominee]) {
25:                    intermediate[intermediateLength] = nominee;
26:                    intermediateLength++;
27:                }
28:            }
29:    
30:            address[] memory output = new address[](intermediateLength);
31:            for (uint256 i = 0; i < intermediateLength; i++) {
32:                output[i] = intermediate[i];
33:            }
34:    
35:            return output;
36:        }

```

[15-36](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilMgmtUtils.sol#L15-L36)

```solidity
File: governance/src/security-council-mgmt/governors/modules/SecurityCouncilMemberElectionGovernorCountingUpgradeable.sol

191:     function selectTopNominees(address[] memory nominees, uint240[] memory weights, uint256 k)
192:             public
193:             pure
194:             returns (address[] memory)
195:         {
196:             if (nominees.length != weights.length) {
197:                 revert LengthsDontMatch(nominees.length, weights.length);
198:             }
199:             if (nominees.length < k) {
200:                 revert NotEnoughNominees(nominees.length, k);
201:             }
202:     
203:             uint256[] memory topNomineesPacked = new uint256[](k);
204:     
205:             for (uint16 i = 0; i < nominees.length; i++) {
206:                 uint256 packed = (uint256(weights[i]) << 16) | i;
207:     
208:                 if (topNomineesPacked[0] < packed) {
209:                     topNomineesPacked[0] = packed;
210:                     LibSort.insertionSort(topNomineesPacked);
211:                 }
212:             }
213:     
214:             address[] memory topNomineesAddresses = new address[](k);
215:             for (uint16 i = 0; i < k; i++) {
216:                 topNomineesAddresses[i] = nominees[uint16(topNomineesPacked[i])];
217:             }
218:     
219:             return topNomineesAddresses;
220:         }

```

[191-220](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilMemberElectionGovernorCountingUpgradeable.sol#L191-L220)

### <a name="G-21"></a>[G-21] `bytes.concat()` can be used instead of `abi.encodePacked`
Given concatenation is not going to be used for hashing `bytes.concat` is the preferred method to use as its more gas efficient

*Instances (1)*:

```solidity
File: governance/src/security-council-mgmt/SecurityCouncilManager.sol

375:         return keccak256(abi.encodePacked(_members, nonce));

```

[375](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L375)

### <a name="G-22"></a>[G-22] The use of a logical AND (`&&`) instead of double `if` is slightly less gas efficient in instances where there isn't a corresponding `else` statement for the given `if` statement
Using a double if statement instead of logical AND (&&) can provide similar short-circuiting behavior whereas double if is slightly more efficient.

*Instances (6)*:

```solidity
File: governance/src/security-council-mgmt/SecurityCouncilManager.sol

255:                 existantSecurityCouncil.chainId == _securityCouncilData.chainId

287:                 securityCouncilData.securityCouncil == _securityCouncilData.securityCouncil

287:                 securityCouncilData.securityCouncil == _securityCouncilData.securityCouncil

```

[255](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L255), [287](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L287), [287](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L287)

```solidity
File: governance/src/security-council-mgmt/governors/SecurityCouncilMemberRemovalGovernor.sol

135:             !securityCouncilManager.firstCohortIncludes(memberToRemove)

183:         if (!(0 < _voteSuccessNumerator && _voteSuccessNumerator <= voteSuccessDenominator)) {

```

[135](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberRemovalGovernor.sol#L135), [183](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberRemovalGovernor.sol#L183)

```solidity
File: governance/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol

369:         return isNominee(proposalId, account) && !_elections[proposalId].isExcluded[account];

```

[369](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol#L369)

### <a name="G-23"></a>[G-23] `>=`/ `<=` costs less gas than `>`/`<`
The compiler uses opcodes `GT` and `ISZERO` for solidity code that uses `>`, but only requires `LT` for `>=`,[which saves 3 gas](https://gist.github.com/IllIllI000/3dc79d25acccfa16dee4e83ffdc6ffde)

*Instances (45)*:
<details>
<summary>see instances</summary>


```solidity
File: governance/src/UpgradeExecRouteBuilder.sol

76:         for (uint256 i = 0; i < _upgradeExecutors.length; i++) {

129:         for (uint256 i = 0; i < chainIds.length; i++) {

193:         for (uint256 i = 0; i < chainIds.length; i++) {

```

[76](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/UpgradeExecRouteBuilder.sol#L76), [129](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/UpgradeExecRouteBuilder.sol#L129), [193](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/UpgradeExecRouteBuilder.sol#L193)

```solidity
File: governance/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/SecurityCouncilMgmtUpgradeLib.sol

61:         for (uint256 i = 0; i < array1.length; i++) {

63:             for (uint256 j = 0; j < array2.length; j++) {

74:         for (uint256 i = 0; i < array2.length; i++) {

76:             for (uint256 j = 0; j < array1.length; j++) {

```

[61](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/SecurityCouncilMgmtUpgradeLib.sol#L61), [63](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/SecurityCouncilMgmtUpgradeLib.sol#L63), [74](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/SecurityCouncilMgmtUpgradeLib.sol#L74), [76](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/gov-action-contracts/AIPs/SecurityCouncilMgmt/SecurityCouncilMgmtUpgradeLib.sol#L76)

```solidity
File: governance/src/security-council-mgmt/SecurityCouncilManager.sol

106:         for (uint256 i = 0; i < _roles.memberRemovers.length; i++) {

118:         for (uint256 i = 0; i < _securityCouncils.length; i++) {

135:         for (uint256 i = 0; i < _newCohort.length; i++) {

162:         for (uint256 i = 0; i < 2; i++) {

164:             for (uint256 j = 0; j < cohort.length; j++) {

251:         for (uint256 i = 0; i < securityCouncils.length; i++) {

284:         for (uint256 i = 0; i < securityCouncils.length; i++) {

339:         for (uint256 i = 0; i < firstCohort.length; i++) {

342:         for (uint256 i = 0; i < secondCohort.length; i++) {

392:         for (uint256 i = 0; i < securityCouncils.length; i++) {

```

[106](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L106), [118](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L118), [135](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L135), [162](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L162), [164](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L164), [251](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L251), [284](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L284), [339](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L339), [342](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L342), [392](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L392)

```solidity
File: governance/src/security-council-mgmt/SecurityCouncilMemberSyncAction.sol

60:         for (uint256 i = 0; i < _updatedMembers.length; i++) {

67:         for (uint256 i = 0; i < previousOwners.length; i++) {

105:         for (uint256 i = 0; i < owners.length; i++) {

```

[60](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilMemberSyncAction.sol#L60), [67](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilMemberSyncAction.sol#L67), [105](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilMemberSyncAction.sol#L105)

```solidity
File: governance/src/security-council-mgmt/SecurityCouncilMgmtUtils.sol

6:         for (uint256 i = 0; i < arr.length; i++) {

22:         for (uint256 i = 0; i < input.length; i++) {

31:         for (uint256 i = 0; i < intermediateLength; i++) {

```

[6](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilMgmtUtils.sol#L6), [22](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilMgmtUtils.sol#L22), [31](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilMgmtUtils.sol#L31)

```solidity
File: governance/src/security-council-mgmt/factories/L2SecurityCouncilMgmtFactory.sol

111:         for (uint256 i = 0; i < dp.firstCohort.length; i++) {

117:         for (uint256 i = 0; i < dp.secondCohort.length; i++) {

```

[111](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/factories/L2SecurityCouncilMgmtFactory.sol#L111), [117](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/factories/L2SecurityCouncilMgmtFactory.sol#L117)

```solidity
File: governance/src/security-council-mgmt/governors/SecurityCouncilMemberElectionGovernor.sol

56:         if (_fullWeightDuration > _votingPeriod) {

```

[56](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberElectionGovernor.sol#L56)

```solidity
File: governance/src/security-council-mgmt/governors/SecurityCouncilMemberRemovalGovernor.sol

157:         return voteSuccessDenominator * forVotes > (forVotes + againstVotes) * voteSuccessNumerator;

183:         if (!(0 < _voteSuccessNumerator && _voteSuccessNumerator <= voteSuccessDenominator)) {

```

[157](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberRemovalGovernor.sol#L157), [183](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilMemberRemovalGovernor.sol#L183)

```solidity
File: governance/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol

128:         if ((quorumDenominator() / params.quorumNumeratorValue) > 500) {

151:         if (block.number > vettingDeadline) {

167:         if (block.timestamp < thisElectionStartTs) {

339:         if (cnCount < cohortSize) {

396:         return (electionCount < 2) ? Cohort.SECOND : electionIndexToCohort(electionCount - 2);

```

[128](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol#L128), [151](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol#L151), [167](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol#L167), [339](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol#L339), [396](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol#L396)

```solidity
File: governance/src/security-council-mgmt/governors/modules/SecurityCouncilMemberElectionGovernorCountingUpgradeable.sol

78:         if (newFullWeightDuration > votingPeriod()) {

122:         if (prevVotesUsed + votes > availableVotes) {

159:         return votesUsed(proposalId, account) > 0;

181:         for (uint256 i = 0; i < nominees.length; i++) {

199:         if (nominees.length < k) {

205:         for (uint16 i = 0; i < nominees.length; i++) {

208:             if (topNomineesPacked[0] < packed) {

215:         for (uint16 i = 0; i < k; i++) {

237:         if (blockNumber > endBlock) {

260:         if (x > type(uint240).max) {

```

[78](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilMemberElectionGovernorCountingUpgradeable.sol#L78), [122](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilMemberElectionGovernorCountingUpgradeable.sol#L122), [159](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilMemberElectionGovernorCountingUpgradeable.sol#L159), [181](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilMemberElectionGovernorCountingUpgradeable.sol#L181), [199](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilMemberElectionGovernorCountingUpgradeable.sol#L199), [205](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilMemberElectionGovernorCountingUpgradeable.sol#L205), [208](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilMemberElectionGovernorCountingUpgradeable.sol#L208), [215](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilMemberElectionGovernorCountingUpgradeable.sol#L215), [237](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilMemberElectionGovernorCountingUpgradeable.sol#L237), [260](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilMemberElectionGovernorCountingUpgradeable.sol#L260)

```solidity
File: governance/src/security-council-mgmt/governors/modules/SecurityCouncilNomineeElectionGovernorCountingUpgradeable.sol

90:         if (votes + prevVotesUsed > weight) {

134:         return _elections[proposalId].votesUsed[account] > 0;

```

[90](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilNomineeElectionGovernorCountingUpgradeable.sol#L90), [134](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilNomineeElectionGovernorCountingUpgradeable.sol#L134)

</details>

### <a name="G-24"></a>[G-24] Use `uint256(1)`/`uint256(2)` instead for `true` and `false` boolean states
Use `uint256(1)` and `uint256(2)` for true/false to avoid a Gwarmaccess (100 gas), and to avoid Gsset (20000 gas) when changing from ‘false’ to ‘true’, after having been ‘true’ in the past. See [source](https://github.com/OpenZeppelin/openzeppelin-contracts/blob/58f635312aa21f947cae5f8578638a85aa2519f5/contracts/security/ReentrancyGuard.sol#L23-L27).

*Instances (4)*:

```solidity
File: governance/src/security-council-mgmt/SecurityCouncilMgmtUtils.sol

17:         mapping(address => bool) storage excludeList

```

[17](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilMgmtUtils.sol#L17)

```solidity
File: governance/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol

55:         mapping(address => bool) isContender;

56:         mapping(address => bool) isExcluded;

```

[55](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol#L55), [56](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/SecurityCouncilNomineeElectionGovernor.sol#L56)

```solidity
File: governance/src/security-council-mgmt/governors/modules/SecurityCouncilNomineeElectionGovernorCountingUpgradeable.sol

22:         mapping(address => bool) isNominee;

```

[22](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/governors/modules/SecurityCouncilNomineeElectionGovernorCountingUpgradeable.sol#L22)
The upcoming v4.8.1 version of OpenZeppelin provides many small gas optimizations.
[Refrence](https://github.com/OpenZeppelin/openzeppelin-contracts/releases/tag/v4.8.1)

*Instances (1)*:

```solidity
File: package.json

/// @audit path: governance
1: version: 4.7.3

```

[1](https://github.com/arbitrumfoundation/governance/blob/c18de53820c505fc459f766c1b224810eaeaabc5/src/security-council-mgmt/SecurityCouncilManager.sol#L1)